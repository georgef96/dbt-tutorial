2021-05-11 09:11:46.615682 (MainThread): Running with dbt=0.19.1
2021-05-11 09:11:47.239327 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/georgefearnley/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-11 09:11:47.240630 (MainThread): Tracking: tracking
2021-05-11 09:11:47.251747 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce211fe4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce2118f580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce2118f520>]}
2021-05-11 09:11:47.265385 (MainThread): Partial parsing not enabled
2021-05-11 09:11:47.284429 (MainThread): Parsing macros/etc.sql
2021-05-11 09:11:47.295001 (MainThread): Parsing macros/catalog.sql
2021-05-11 09:11:47.302670 (MainThread): Parsing macros/adapters.sql
2021-05-11 09:11:47.334024 (MainThread): Parsing macros/materializations/seed.sql
2021-05-11 09:11:47.337945 (MainThread): Parsing macros/materializations/view.sql
2021-05-11 09:11:47.341608 (MainThread): Parsing macros/materializations/table.sql
2021-05-11 09:11:47.352510 (MainThread): Parsing macros/materializations/copy.sql
2021-05-11 09:11:47.357730 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-11 09:11:47.384945 (MainThread): Parsing macros/materializations/snapshot.sql
2021-05-11 09:11:47.393753 (MainThread): Parsing macros/core.sql
2021-05-11 09:11:47.398989 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-11 09:11:47.408938 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-11 09:11:47.411609 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-11 09:11:47.434441 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-11 09:11:47.467007 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-11 09:11:47.487148 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-11 09:11:47.489616 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-11 09:11:47.495772 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-11 09:11:47.509743 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-11 09:11:47.517146 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-11 09:11:47.534030 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-11 09:11:47.539865 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-11 09:11:47.541528 (MainThread): Parsing macros/etc/query.sql
2021-05-11 09:11:47.543334 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-11 09:11:47.545779 (MainThread): Parsing macros/etc/datetime.sql
2021-05-11 09:11:47.554843 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-11 09:11:47.557356 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-11 09:11:47.559981 (MainThread): Parsing macros/adapters/common.sql
2021-05-11 09:11:47.603255 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-11 09:11:47.605956 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-11 09:11:47.608103 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-11 09:11:47.610457 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-11 09:11:47.634344 (MainThread): Partial parsing not enabled
2021-05-11 09:11:47.660931 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-05-11 09:11:47.685962 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-05-11 09:11:47.759045 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59ac24b2-eedc-4f1f-b667-b9daa09b02a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce21400730>]}
2021-05-11 09:11:47.764221 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59ac24b2-eedc-4f1f-b667-b9daa09b02a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce21468d60>]}
2021-05-11 09:11:47.764460 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-11 09:11:47.765283 (MainThread): 
2021-05-11 09:11:47.765563 (MainThread): Acquiring new bigquery connection "master".
2021-05-11 09:11:47.766391 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_acquired-rite-313314".
2021-05-11 09:11:47.766669 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-11 09:11:48.378627 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "create_acquired-rite-313314_dbt_george".
2021-05-11 09:11:48.379097 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "create_acquired-rite-313314_dbt_george".
2021-05-11 09:11:48.379257 (ThreadPoolExecutor-0_0): Creating schema "acquired-rite-313314.dbt_george".
2021-05-11 09:11:48.379422 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-05-11 09:11:48.386605 (ThreadPoolExecutor-0_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-11 09:11:49.151464 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_acquired-rite-313314_dbt_george".
2021-05-11 09:11:49.151874 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-11 09:11:49.158493 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-11 09:11:49.159040 (ThreadPoolExecutor-1_0): unclosed <socket.socket fd=13, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.0.104', 54313), raddr=('142.250.200.42', 443)>
2021-05-11 09:11:49.159185 (ThreadPoolExecutor-1_0): unclosed <socket.socket fd=14, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.0.104', 54314), raddr=('142.250.187.234', 443)>
2021-05-11 09:11:49.679491 (MainThread): 10:11:49 | Concurrency: 1 threads (target='dev')
2021-05-11 09:11:49.679774 (MainThread): 10:11:49 | 
2021-05-11 09:11:49.687271 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2021-05-11 09:11:49.687576 (Thread-1): 10:11:49 | 1 of 2 START table model dbt_george.my_first_dbt_model............... [RUN]
2021-05-11 09:11:49.688116 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-05-11 09:11:49.688251 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2021-05-11 09:11:49.690490 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-05-11 09:11:49.691294 (Thread-1): finished collecting timing info
2021-05-11 09:11:49.728323 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-05-11 09:11:49.729031 (Thread-1): Opening a new connection, currently in state closed
2021-05-11 09:11:49.734280 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `acquired-rite-313314`.`dbt_george`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2021-05-11 09:11:53.453052 (Thread-1): finished collecting timing info
2021-05-11 09:11:53.453570 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59ac24b2-eedc-4f1f-b667-b9daa09b02a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce213637c0>]}
2021-05-11 09:11:53.453910 (Thread-1): 10:11:53 | 1 of 2 OK created table model dbt_george.my_first_dbt_model.......... [CREATE TABLE (2.0 rows, 0.0 Bytes processed) in 3.77s]
2021-05-11 09:11:53.454055 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2021-05-11 09:11:53.454625 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2021-05-11 09:11:53.454847 (Thread-1): 10:11:53 | 2 of 2 START view model dbt_george.my_second_dbt_model............... [RUN]
2021-05-11 09:11:53.455111 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-05-11 09:11:53.455229 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2021-05-11 09:11:53.455801 (Thread-1): unclosed <socket.socket fd=19, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.0.104', 54319), raddr=('142.250.200.42', 443)>
2021-05-11 09:11:53.455958 (Thread-1): unclosed <socket.socket fd=20, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.0.104', 54320), raddr=('142.250.187.234', 443)>
2021-05-11 09:11:53.457752 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-05-11 09:11:53.458203 (Thread-1): finished collecting timing info
2021-05-11 09:11:53.475478 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-05-11 09:11:53.475904 (Thread-1): Opening a new connection, currently in state closed
2021-05-11 09:11:53.481092 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `acquired-rite-313314`.`dbt_george`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `acquired-rite-313314`.`dbt_george`.`my_first_dbt_model`
where id = 1;


2021-05-11 09:11:54.760379 (Thread-1): finished collecting timing info
2021-05-11 09:11:54.760862 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59ac24b2-eedc-4f1f-b667-b9daa09b02a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce21ad1f10>]}
2021-05-11 09:11:54.761249 (Thread-1): 10:11:54 | 2 of 2 OK created view model dbt_george.my_second_dbt_model.......... [OK in 1.31s]
2021-05-11 09:11:54.761485 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2021-05-11 09:11:54.762594 (MainThread): Acquiring new bigquery connection "master".
2021-05-11 09:11:54.762955 (MainThread): 10:11:54 | 
2021-05-11 09:11:54.763121 (MainThread): 10:11:54 | Finished running 1 table model, 1 view model in 7.00s.
2021-05-11 09:11:54.763269 (MainThread): Connection 'master' was properly closed.
2021-05-11 09:11:54.763372 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2021-05-11 09:11:54.785668 (MainThread): 
2021-05-11 09:11:54.785877 (MainThread): Completed successfully
2021-05-11 09:11:54.786036 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-05-11 09:11:54.786244 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce21321040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce213463a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce21ac6d90>]}
2021-05-11 09:11:54.786498 (MainThread): Flushing usage events
2021-05-11 09:49:15.168090 (MainThread): Running with dbt=0.19.1
2021-05-11 09:49:15.652626 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/georgefearnley/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-11 09:49:15.654299 (MainThread): Tracking: tracking
2021-05-11 09:49:15.663058 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4546ffcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff45468f6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff45468f640>]}
2021-05-11 09:49:15.675594 (MainThread): Partial parsing not enabled
2021-05-11 09:49:15.677943 (MainThread): Parsing macros/etc.sql
2021-05-11 09:49:15.698840 (MainThread): Parsing macros/catalog.sql
2021-05-11 09:49:15.708381 (MainThread): Parsing macros/adapters.sql
2021-05-11 09:49:15.728978 (MainThread): Parsing macros/materializations/seed.sql
2021-05-11 09:49:15.749309 (MainThread): Parsing macros/materializations/view.sql
2021-05-11 09:49:15.754516 (MainThread): Parsing macros/materializations/table.sql
2021-05-11 09:49:15.766215 (MainThread): Parsing macros/materializations/copy.sql
2021-05-11 09:49:15.771441 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-11 09:49:15.798851 (MainThread): Parsing macros/materializations/snapshot.sql
2021-05-11 09:49:15.805284 (MainThread): Parsing macros/core.sql
2021-05-11 09:49:15.810268 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-11 09:49:15.820147 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-11 09:49:15.822719 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-11 09:49:15.849126 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-11 09:49:15.899015 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-11 09:49:15.924233 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-11 09:49:15.926786 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-11 09:49:15.948958 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-11 09:49:15.966112 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-11 09:49:15.973973 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-11 09:49:15.981279 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-11 09:49:15.998725 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-11 09:49:16.000717 (MainThread): Parsing macros/etc/query.sql
2021-05-11 09:49:16.002688 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-11 09:49:16.005376 (MainThread): Parsing macros/etc/datetime.sql
2021-05-11 09:49:16.015280 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-11 09:49:16.018172 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-11 09:49:16.021025 (MainThread): Parsing macros/adapters/common.sql
2021-05-11 09:49:16.063399 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-11 09:49:16.065891 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-11 09:49:16.067946 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-11 09:49:16.070438 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-11 09:49:16.078170 (MainThread): Partial parsing not enabled
2021-05-11 09:49:16.106804 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-05-11 09:49:16.116169 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-05-11 09:49:16.120492 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-05-11 09:49:16.184718 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd1556a5-90e8-451c-9f23-4037b14cc2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff45519b910>]}
2021-05-11 09:49:16.200808 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd1556a5-90e8-451c-9f23-4037b14cc2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff45472eb50>]}
2021-05-11 09:49:16.201078 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-11 09:49:16.201921 (MainThread): 
2021-05-11 09:49:16.202220 (MainThread): Acquiring new bigquery connection "master".
2021-05-11 09:49:16.203093 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_acquired-rite-313314".
2021-05-11 09:49:16.203331 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-11 09:50:32.538605 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_acquired-rite-313314_dbt_george".
2021-05-11 09:50:32.538780 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-11 09:50:32.544511 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-11 09:50:33.137362 (MainThread): 10:50:33 | Concurrency: 1 threads (target='dev')
2021-05-11 09:50:33.137530 (MainThread): 10:50:33 | 
2021-05-11 09:50:33.151137 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2021-05-11 09:50:33.151403 (Thread-1): 10:50:33 | 1 of 3 START table model dbt_george.my_first_dbt_model............... [RUN]
2021-05-11 09:50:33.151680 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-05-11 09:50:33.151794 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2021-05-11 09:50:33.153890 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-05-11 09:50:33.154800 (Thread-1): finished collecting timing info
2021-05-11 09:50:33.172585 (Thread-1): Opening a new connection, currently in state closed
2021-05-11 09:50:33.178005 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-11 09:50:33.682878 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-05-11 09:50:33.700847 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `acquired-rite-313314`.`dbt_george`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2021-05-11 09:50:35.623110 (Thread-1): finished collecting timing info
2021-05-11 09:50:35.623549 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd1556a5-90e8-451c-9f23-4037b14cc2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff455186040>]}
2021-05-11 09:50:35.623897 (Thread-1): 10:50:35 | 1 of 3 OK created table model dbt_george.my_first_dbt_model.......... [CREATE TABLE (2.0 rows, 0.0 Bytes processed) in 2.47s]
2021-05-11 09:50:35.624075 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2021-05-11 09:50:35.624222 (Thread-1): Began running node model.jaffle_shop.customers
2021-05-11 09:50:35.624529 (Thread-1): 10:50:35 | 2 of 3 START view model dbt_george.customers......................... [RUN]
2021-05-11 09:50:35.624927 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-05-11 09:50:35.625056 (Thread-1): Compiling model.jaffle_shop.customers
2021-05-11 09:50:35.626214 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2021-05-11 09:50:35.626674 (Thread-1): finished collecting timing info
2021-05-11 09:50:35.644523 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2021-05-11 09:50:35.644949 (Thread-1): Opening a new connection, currently in state closed
2021-05-11 09:50:35.651104 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `acquired-rite-313314`.`dbt_george`.`customers`
  OPTIONS()
  as with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2021-05-11 09:50:36.743909 (Thread-1): finished collecting timing info
2021-05-11 09:50:36.744381 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd1556a5-90e8-451c-9f23-4037b14cc2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff455186040>]}
2021-05-11 09:50:36.744774 (Thread-1): 10:50:36 | 2 of 3 OK created view model dbt_george.customers.................... [OK in 1.12s]
2021-05-11 09:50:36.744940 (Thread-1): Finished running node model.jaffle_shop.customers
2021-05-11 09:50:36.745106 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2021-05-11 09:50:36.745436 (Thread-1): 10:50:36 | 3 of 3 START view model dbt_george.my_second_dbt_model............... [RUN]
2021-05-11 09:50:36.745761 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-05-11 09:50:36.745895 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2021-05-11 09:50:36.748412 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-05-11 09:50:36.749936 (Thread-1): finished collecting timing info
2021-05-11 09:50:36.751635 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-05-11 09:50:36.752756 (Thread-1): Opening a new connection, currently in state closed
2021-05-11 09:50:36.759062 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `acquired-rite-313314`.`dbt_george`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `acquired-rite-313314`.`dbt_george`.`my_first_dbt_model`
where id = 1;


2021-05-11 09:50:36.760201 (Thread-1): unclosed <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.0.104', 55177), raddr=('172.217.16.234', 443)>
2021-05-11 09:50:36.760392 (Thread-1): unclosed <socket.socket fd=14, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.0.104', 55196), raddr=('142.250.187.234', 443)>
2021-05-11 09:50:36.760536 (Thread-1): unclosed <socket.socket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.0.104', 55184), raddr=('142.250.187.234', 443)>
2021-05-11 09:50:36.760704 (Thread-1): unclosed <socket.socket fd=13, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.0.104', 55192), raddr=('172.217.16.234', 443)>
2021-05-11 09:50:36.760841 (Thread-1): unclosed <socket.socket fd=19, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.0.104', 55203), raddr=('172.217.16.234', 443)>
2021-05-11 09:50:36.760970 (Thread-1): unclosed <socket.socket fd=20, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.0.104', 55206), raddr=('142.250.187.234', 443)>
2021-05-11 09:50:36.761107 (Thread-1): unclosed <socket.socket fd=22, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.0.104', 55216), raddr=('142.250.187.234', 443)>
2021-05-11 09:50:36.761220 (Thread-1): unclosed <socket.socket fd=21, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.0.104', 55215), raddr=('172.217.16.234', 443)>
2021-05-11 09:50:37.813296 (Thread-1): finished collecting timing info
2021-05-11 09:50:37.813690 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd1556a5-90e8-451c-9f23-4037b14cc2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff455186700>]}
2021-05-11 09:50:37.814008 (Thread-1): 10:50:37 | 3 of 3 OK created view model dbt_george.my_second_dbt_model.......... [OK in 1.07s]
2021-05-11 09:50:37.814145 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2021-05-11 09:50:37.815798 (MainThread): Acquiring new bigquery connection "master".
2021-05-11 09:50:37.816089 (MainThread): 10:50:37 | 
2021-05-11 09:50:37.816220 (MainThread): 10:50:37 | Finished running 1 table model, 2 view models in 81.61s.
2021-05-11 09:50:37.816328 (MainThread): Connection 'master' was properly closed.
2021-05-11 09:50:37.816406 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2021-05-11 09:50:37.822380 (MainThread): 
2021-05-11 09:50:37.822518 (MainThread): Completed successfully
2021-05-11 09:50:37.822645 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-05-11 09:50:37.822812 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff45517ab80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff45510a790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4551683d0>]}
2021-05-11 09:50:37.822995 (MainThread): Flushing usage events
2021-05-11 14:17:42.589345 (MainThread): Running with dbt=0.19.1
2021-05-11 14:17:43.712982 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/georgefearnley/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-11 14:17:43.738223 (MainThread): Tracking: tracking
2021-05-11 14:17:43.760005 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc11f8fdfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc11f8945b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc11f894550>]}
2021-05-11 14:17:43.787579 (MainThread): Partial parsing not enabled
2021-05-11 14:17:43.793236 (MainThread): Parsing macros/etc.sql
2021-05-11 14:17:43.801705 (MainThread): Parsing macros/catalog.sql
2021-05-11 14:17:43.810033 (MainThread): Parsing macros/adapters.sql
2021-05-11 14:17:43.837083 (MainThread): Parsing macros/materializations/seed.sql
2021-05-11 14:17:43.840983 (MainThread): Parsing macros/materializations/view.sql
2021-05-11 14:17:43.845625 (MainThread): Parsing macros/materializations/table.sql
2021-05-11 14:17:43.858324 (MainThread): Parsing macros/materializations/copy.sql
2021-05-11 14:17:43.887153 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-11 14:17:43.902312 (MainThread): Parsing macros/materializations/snapshot.sql
2021-05-11 14:17:43.912423 (MainThread): Parsing macros/core.sql
2021-05-11 14:17:43.917797 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-11 14:17:43.937209 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-11 14:17:43.940720 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-11 14:17:43.961174 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-11 14:17:43.998389 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-11 14:17:44.037195 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-11 14:17:44.040500 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-11 14:17:44.048022 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-11 14:17:44.064130 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-11 14:17:44.087742 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-11 14:17:44.096366 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-11 14:17:44.103274 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-11 14:17:44.105371 (MainThread): Parsing macros/etc/query.sql
2021-05-11 14:17:44.107646 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-11 14:17:44.111577 (MainThread): Parsing macros/etc/datetime.sql
2021-05-11 14:17:44.137367 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-11 14:17:44.141195 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-11 14:17:44.144789 (MainThread): Parsing macros/adapters/common.sql
2021-05-11 14:17:44.193000 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-11 14:17:44.196729 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-11 14:17:44.199801 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-11 14:17:44.202799 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-11 14:17:44.210858 (MainThread): Partial parsing not enabled
2021-05-11 14:17:44.246142 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-05-11 14:17:44.256687 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-05-11 14:17:44.261726 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-05-11 14:17:44.358906 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c500614-f9fb-45ab-9db3-f2a86d51f98c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc11fb5c820>]}
2021-05-11 14:17:44.388295 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c500614-f9fb-45ab-9db3-f2a86d51f98c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc11f909ee0>]}
2021-05-11 14:17:44.388578 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-11 14:17:44.389458 (MainThread): 
2021-05-11 14:17:44.389765 (MainThread): Acquiring new bigquery connection "master".
2021-05-11 14:17:44.390697 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_acquired-rite-313314".
2021-05-11 14:17:44.390930 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-11 14:17:44.907596 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_acquired-rite-313314_dbt_george".
2021-05-11 14:17:44.907835 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-11 14:17:44.914055 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-11 14:17:45.230844 (MainThread): 15:17:45 | Concurrency: 1 threads (target='dev')
2021-05-11 14:17:45.231083 (MainThread): 15:17:45 | 
2021-05-11 14:17:45.242156 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2021-05-11 14:17:45.242438 (Thread-1): 15:17:45 | 1 of 3 START table model dbt_george.my_first_dbt_model............... [RUN]
2021-05-11 14:17:45.242734 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-05-11 14:17:45.242844 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2021-05-11 14:17:45.244942 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-05-11 14:17:45.249323 (Thread-1): finished collecting timing info
2021-05-11 14:17:45.267813 (Thread-1): Opening a new connection, currently in state closed
2021-05-11 14:17:45.273557 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-11 14:17:45.622463 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-05-11 14:17:45.638052 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `acquired-rite-313314`.`dbt_george`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2021-05-11 14:17:47.699687 (Thread-1): finished collecting timing info
2021-05-11 14:17:47.700498 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c500614-f9fb-45ab-9db3-f2a86d51f98c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc11fb46cd0>]}
2021-05-11 14:17:47.700879 (Thread-1): 15:17:47 | 1 of 3 OK created table model dbt_george.my_first_dbt_model.......... [CREATE TABLE (2.0 rows, 0.0 Bytes processed) in 2.46s]
2021-05-11 14:17:47.701009 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2021-05-11 14:17:47.701131 (Thread-1): Began running node model.jaffle_shop.customers
2021-05-11 14:17:47.701382 (Thread-1): 15:17:47 | 2 of 3 START table model dbt_george.customers........................ [RUN]
2021-05-11 14:17:47.701734 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-05-11 14:17:47.701849 (Thread-1): Compiling model.jaffle_shop.customers
2021-05-11 14:17:47.703057 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2021-05-11 14:17:47.707067 (Thread-1): finished collecting timing info
2021-05-11 14:17:47.708419 (Thread-1): Opening a new connection, currently in state closed
2021-05-11 14:17:47.713703 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-11 14:17:48.117976 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-11 14:17:48.363207 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2021-05-11 14:17:48.366173 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace table `acquired-rite-313314`.`dbt_george`.`customers`
  
  
  OPTIONS()
  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
    
2021-05-11 14:17:50.884152 (Thread-1): finished collecting timing info
2021-05-11 14:17:50.884517 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c500614-f9fb-45ab-9db3-f2a86d51f98c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc11fb59640>]}
2021-05-11 14:17:50.884793 (Thread-1): 15:17:50 | 2 of 3 OK created table model dbt_george.customers................... [CREATE TABLE (100.0 rows, 4.3 KB processed) in 3.18s]
2021-05-11 14:17:50.884913 (Thread-1): Finished running node model.jaffle_shop.customers
2021-05-11 14:17:50.885034 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2021-05-11 14:17:50.885202 (Thread-1): 15:17:50 | 3 of 3 START view model dbt_george.my_second_dbt_model............... [RUN]
2021-05-11 14:17:50.885436 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-05-11 14:17:50.885596 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2021-05-11 14:17:50.887605 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-05-11 14:17:50.889669 (Thread-1): finished collecting timing info
2021-05-11 14:17:50.905493 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-05-11 14:17:50.907569 (Thread-1): Opening a new connection, currently in state closed
2021-05-11 14:17:50.912838 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `acquired-rite-313314`.`dbt_george`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `acquired-rite-313314`.`dbt_george`.`my_first_dbt_model`
where id = 1;


2021-05-11 14:17:50.953657 (Thread-1): unclosed <socket.socket fd=10, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:7d65:8782:3ca8:d975', 58072, 0, 0), raddr=('2a00:1450:4009:816::200a', 443, 0, 0)>
2021-05-11 14:17:50.953859 (Thread-1): unclosed <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:7d65:8782:3ca8:d975', 58073, 0, 0), raddr=('2a00:1450:4009:822::200a', 443, 0, 0)>
2021-05-11 14:17:50.953979 (Thread-1): unclosed <socket.socket fd=13, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:7d65:8782:3ca8:d975', 58075, 0, 0), raddr=('2a00:1450:4009:822::200a', 443, 0, 0)>
2021-05-11 14:17:50.954124 (Thread-1): unclosed <socket.socket fd=12, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:7d65:8782:3ca8:d975', 58074, 0, 0), raddr=('2a00:1450:4009:816::200a', 443, 0, 0)>
2021-05-11 14:17:50.954239 (Thread-1): unclosed <socket.socket fd=19, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:7d65:8782:3ca8:d975', 58077, 0, 0), raddr=('2a00:1450:4009:822::200a', 443, 0, 0)>
2021-05-11 14:17:50.954350 (Thread-1): unclosed <socket.socket fd=18, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:7d65:8782:3ca8:d975', 58076, 0, 0), raddr=('2a00:1450:4009:816::200a', 443, 0, 0)>
2021-05-11 14:17:50.954473 (Thread-1): unclosed <socket.socket fd=21, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:7d65:8782:3ca8:d975', 58080, 0, 0), raddr=('2a00:1450:4009:822::200a', 443, 0, 0)>
2021-05-11 14:17:50.954581 (Thread-1): unclosed <socket.socket fd=20, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:7d65:8782:3ca8:d975', 58079, 0, 0), raddr=('2a00:1450:4009:816::200a', 443, 0, 0)>
2021-05-11 14:17:51.763558 (Thread-1): finished collecting timing info
2021-05-11 14:17:51.763950 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c500614-f9fb-45ab-9db3-f2a86d51f98c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc11ffaa700>]}
2021-05-11 14:17:51.764257 (Thread-1): 15:17:51 | 3 of 3 OK created view model dbt_george.my_second_dbt_model.......... [OK in 0.88s]
2021-05-11 14:17:51.764393 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2021-05-11 14:17:51.766103 (MainThread): Acquiring new bigquery connection "master".
2021-05-11 14:17:51.766405 (MainThread): 15:17:51 | 
2021-05-11 14:17:51.766534 (MainThread): 15:17:51 | Finished running 2 table models, 1 view model in 7.38s.
2021-05-11 14:17:51.766641 (MainThread): Connection 'master' was properly closed.
2021-05-11 14:17:51.766718 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2021-05-11 14:17:51.793456 (MainThread): 
2021-05-11 14:17:51.793625 (MainThread): Completed successfully
2021-05-11 14:17:51.793744 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-05-11 14:17:51.793902 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc11f9094f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc11faca670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc11facaf70>]}
2021-05-11 14:17:51.794076 (MainThread): Flushing usage events
2021-05-11 14:22:31.607883 (MainThread): Running with dbt=0.19.1
2021-05-11 14:22:32.144668 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/georgefearnley/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-11 14:22:32.147243 (MainThread): Tracking: tracking
2021-05-11 14:22:32.163840 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb1e13d5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb1e0d25b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb1e0d2550>]}
2021-05-11 14:22:32.192240 (MainThread): Partial parsing not enabled
2021-05-11 14:22:32.197087 (MainThread): Parsing macros/etc.sql
2021-05-11 14:22:32.202085 (MainThread): Parsing macros/catalog.sql
2021-05-11 14:22:32.209517 (MainThread): Parsing macros/adapters.sql
2021-05-11 14:22:32.239876 (MainThread): Parsing macros/materializations/seed.sql
2021-05-11 14:22:32.243858 (MainThread): Parsing macros/materializations/view.sql
2021-05-11 14:22:32.248215 (MainThread): Parsing macros/materializations/table.sql
2021-05-11 14:22:32.259209 (MainThread): Parsing macros/materializations/copy.sql
2021-05-11 14:22:32.264575 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-11 14:22:32.289986 (MainThread): Parsing macros/materializations/snapshot.sql
2021-05-11 14:22:32.297769 (MainThread): Parsing macros/core.sql
2021-05-11 14:22:32.302442 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-11 14:22:32.312201 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-11 14:22:32.314801 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-11 14:22:32.340118 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-11 14:22:32.389907 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-11 14:22:32.413273 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-11 14:22:32.415926 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-11 14:22:32.423027 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-11 14:22:32.439993 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-11 14:22:32.447825 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-11 14:22:32.455490 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-11 14:22:32.461185 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-11 14:22:32.462803 (MainThread): Parsing macros/etc/query.sql
2021-05-11 14:22:32.464631 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-11 14:22:32.466989 (MainThread): Parsing macros/etc/datetime.sql
2021-05-11 14:22:32.489947 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-11 14:22:32.493139 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-11 14:22:32.495722 (MainThread): Parsing macros/adapters/common.sql
2021-05-11 14:22:32.541971 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-11 14:22:32.544451 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-11 14:22:32.546556 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-11 14:22:32.548917 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-11 14:22:32.557149 (MainThread): Partial parsing not enabled
2021-05-11 14:22:32.598088 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-05-11 14:22:32.608704 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-05-11 14:22:32.612833 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-05-11 14:22:32.707228 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e38072ee-c93f-4671-aef1-00211bc2fe34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb1e59b820>]}
2021-05-11 14:22:32.714695 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e38072ee-c93f-4671-aef1-00211bc2fe34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb1e1484f0>]}
2021-05-11 14:22:32.714950 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-11 14:22:32.715728 (MainThread): 
2021-05-11 14:22:32.716003 (MainThread): Acquiring new bigquery connection "master".
2021-05-11 14:22:32.716801 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_acquired-rite-313314".
2021-05-11 14:22:32.717006 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-11 14:22:33.101475 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_acquired-rite-313314_dbt_george".
2021-05-11 14:22:33.101665 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-11 14:22:33.106870 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-11 14:22:33.435399 (MainThread): 15:22:33 | Concurrency: 1 threads (target='dev')
2021-05-11 14:22:33.435569 (MainThread): 15:22:33 | 
2021-05-11 14:22:33.441433 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2021-05-11 14:22:33.441665 (Thread-1): 15:22:33 | 1 of 3 START table model dbt_george.my_first_dbt_model............... [RUN]
2021-05-11 14:22:33.441916 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-05-11 14:22:33.442030 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2021-05-11 14:22:33.444079 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-05-11 14:22:33.446259 (Thread-1): finished collecting timing info
2021-05-11 14:22:33.464552 (Thread-1): Opening a new connection, currently in state closed
2021-05-11 14:22:33.469886 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-11 14:22:33.846085 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-05-11 14:22:33.848380 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `acquired-rite-313314`.`dbt_george`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2021-05-11 14:22:36.421548 (Thread-1): finished collecting timing info
2021-05-11 14:22:36.421923 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e38072ee-c93f-4671-aef1-00211bc2fe34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb1e4a1670>]}
2021-05-11 14:22:36.422208 (Thread-1): 15:22:36 | 1 of 3 OK created table model dbt_george.my_first_dbt_model.......... [CREATE TABLE (2.0 rows, 0.0 Bytes processed) in 2.98s]
2021-05-11 14:22:36.422327 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2021-05-11 14:22:36.422443 (Thread-1): Began running node model.jaffle_shop.customers
2021-05-11 14:22:36.422689 (Thread-1): 15:22:36 | 2 of 3 START view model dbt_george.customers......................... [RUN]
2021-05-11 14:22:36.422995 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-05-11 14:22:36.423100 (Thread-1): Compiling model.jaffle_shop.customers
2021-05-11 14:22:36.424968 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2021-05-11 14:22:36.441694 (Thread-1): finished collecting timing info
2021-05-11 14:22:36.460722 (Thread-1): finished collecting timing info
2021-05-11 14:22:36.461079 (Thread-1): Compilation Error in model customers (models/customers.sql)
  Trying to create view `acquired-rite-313314`.`dbt_george`.`customers`, but it currently exists as a table. Either drop `acquired-rite-313314`.`dbt_george`.`customers` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
  > called by macro handle_existing_table (macros/materializations/view/create_or_replace_view.sql)
  > called by macro create_or_replace_view (macros/materializations/view/create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros/materializations/view.sql)
  > called by model customers (models/customers.sql)
Traceback (most recent call last):
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 50, in macro
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 29, in macro
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/exceptions.py", line 1008, in inner
    raise exc
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/exceptions.py", line 1005, in inner
    return func(*args, **kwargs)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/exceptions.py", line 669, in relation_wrong_type
    raise_compiler_error(
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model customers (models/customers.sql)
  Trying to create view `acquired-rite-313314`.`dbt_george`.`customers`, but it currently exists as a table. Either drop `acquired-rite-313314`.`dbt_george`.`customers` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
  > called by macro handle_existing_table (macros/materializations/view/create_or_replace_view.sql)
  > called by macro create_or_replace_view (macros/materializations/view/create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros/materializations/view.sql)
  > called by model customers (models/customers.sql)
2021-05-11 14:22:36.493893 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e38072ee-c93f-4671-aef1-00211bc2fe34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb1e542850>]}
2021-05-11 14:22:36.494220 (Thread-1): 15:22:36 | 2 of 3 ERROR creating view model dbt_george.customers................ [ERROR in 0.07s]
2021-05-11 14:22:36.494368 (Thread-1): Finished running node model.jaffle_shop.customers
2021-05-11 14:22:36.494488 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2021-05-11 14:22:36.494773 (Thread-1): 15:22:36 | 3 of 3 START view model dbt_george.my_second_dbt_model............... [RUN]
2021-05-11 14:22:36.495021 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-05-11 14:22:36.495114 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2021-05-11 14:22:36.497092 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-05-11 14:22:36.498241 (Thread-1): finished collecting timing info
2021-05-11 14:22:36.503177 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-05-11 14:22:36.504243 (Thread-1): Opening a new connection, currently in state closed
2021-05-11 14:22:36.509558 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `acquired-rite-313314`.`dbt_george`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `acquired-rite-313314`.`dbt_george`.`my_first_dbt_model`
where id = 1;


2021-05-11 14:22:37.639893 (Thread-1): finished collecting timing info
2021-05-11 14:22:37.640291 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e38072ee-c93f-4671-aef1-00211bc2fe34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb1e5426a0>]}
2021-05-11 14:22:37.640593 (Thread-1): 15:22:37 | 3 of 3 OK created view model dbt_george.my_second_dbt_model.......... [OK in 1.15s]
2021-05-11 14:22:37.640741 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2021-05-11 14:22:37.641757 (MainThread): Acquiring new bigquery connection "master".
2021-05-11 14:22:37.642047 (MainThread): 15:22:37 | 
2021-05-11 14:22:37.642173 (MainThread): 15:22:37 | Finished running 1 table model, 2 view models in 4.93s.
2021-05-11 14:22:37.642279 (MainThread): Connection 'master' was properly closed.
2021-05-11 14:22:37.642353 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2021-05-11 14:22:37.643824 (MainThread): unclosed <socket.socket fd=10, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:7d65:8782:3ca8:d975', 58124, 0, 0), raddr=('2a00:1450:4009:817::200a', 443, 0, 0)>
2021-05-11 14:22:37.643981 (MainThread): unclosed <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:7d65:8782:3ca8:d975', 58125, 0, 0), raddr=('2a00:1450:4009:822::200a', 443, 0, 0)>
2021-05-11 14:22:37.644109 (MainThread): unclosed <socket.socket fd=13, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:7d65:8782:3ca8:d975', 58127, 0, 0), raddr=('2a00:1450:4009:822::200a', 443, 0, 0)>
2021-05-11 14:22:37.644242 (MainThread): unclosed <socket.socket fd=12, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:7d65:8782:3ca8:d975', 58126, 0, 0), raddr=('2a00:1450:4009:817::200a', 443, 0, 0)>
2021-05-11 14:22:37.644376 (MainThread): unclosed <socket.socket fd=19, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:7d65:8782:3ca8:d975', 58129, 0, 0), raddr=('2a00:1450:4009:822::200a', 443, 0, 0)>
2021-05-11 14:22:37.644500 (MainThread): unclosed <socket.socket fd=18, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:7d65:8782:3ca8:d975', 58128, 0, 0), raddr=('2a00:1450:4009:817::200a', 443, 0, 0)>
2021-05-11 14:22:37.644646 (MainThread): unclosed <socket.socket fd=20, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:7d65:8782:3ca8:d975', 58130, 0, 0), raddr=('2a00:1450:4009:817::200a', 443, 0, 0)>
2021-05-11 14:22:37.644783 (MainThread): unclosed <socket.socket fd=21, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:7d65:8782:3ca8:d975', 58131, 0, 0), raddr=('2a00:1450:4009:822::200a', 443, 0, 0)>
2021-05-11 14:22:37.650048 (MainThread): 
2021-05-11 14:22:37.650195 (MainThread): Completed with 1 error and 0 warnings:
2021-05-11 14:22:37.650301 (MainThread): 
2021-05-11 14:22:37.650400 (MainThread): Compilation Error in model customers (models/customers.sql)
2021-05-11 14:22:37.650491 (MainThread):   Trying to create view `acquired-rite-313314`.`dbt_george`.`customers`, but it currently exists as a table. Either drop `acquired-rite-313314`.`dbt_george`.`customers` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
2021-05-11 14:22:37.650576 (MainThread):   
2021-05-11 14:22:37.650657 (MainThread):   > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
2021-05-11 14:22:37.650738 (MainThread):   > called by macro handle_existing_table (macros/materializations/view/create_or_replace_view.sql)
2021-05-11 14:22:37.650818 (MainThread):   > called by macro create_or_replace_view (macros/materializations/view/create_or_replace_view.sql)
2021-05-11 14:22:37.650898 (MainThread):   > called by macro materialization_view_bigquery (macros/materializations/view.sql)
2021-05-11 14:22:37.650976 (MainThread):   > called by model customers (models/customers.sql)
2021-05-11 14:22:37.651071 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-11 14:22:37.651220 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb1e44cb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb1e53a640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb1e537250>]}
2021-05-11 14:22:37.651391 (MainThread): Flushing usage events
2021-05-11 14:23:03.342821 (MainThread): Running with dbt=0.19.1
2021-05-11 14:23:03.845053 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/georgefearnley/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-11 14:23:03.846374 (MainThread): Tracking: tracking
2021-05-11 14:23:03.857808 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a1c2fef70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a1c296550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a1c2964f0>]}
2021-05-11 14:23:03.871321 (MainThread): Partial parsing not enabled
2021-05-11 14:23:03.890288 (MainThread): Parsing macros/etc.sql
2021-05-11 14:23:03.894447 (MainThread): Parsing macros/catalog.sql
2021-05-11 14:23:03.902329 (MainThread): Parsing macros/adapters.sql
2021-05-11 14:23:03.922991 (MainThread): Parsing macros/materializations/seed.sql
2021-05-11 14:23:03.940432 (MainThread): Parsing macros/materializations/view.sql
2021-05-11 14:23:03.944445 (MainThread): Parsing macros/materializations/table.sql
2021-05-11 14:23:03.955518 (MainThread): Parsing macros/materializations/copy.sql
2021-05-11 14:23:03.960670 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-11 14:23:03.990323 (MainThread): Parsing macros/materializations/snapshot.sql
2021-05-11 14:23:03.995840 (MainThread): Parsing macros/core.sql
2021-05-11 14:23:04.000500 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-11 14:23:04.010407 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-11 14:23:04.012924 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-11 14:23:04.040315 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-11 14:23:04.090372 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-11 14:23:04.113440 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-11 14:23:04.116213 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-11 14:23:04.123508 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-11 14:23:04.140221 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-11 14:23:04.147706 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-11 14:23:04.155128 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-11 14:23:04.160728 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-11 14:23:04.162386 (MainThread): Parsing macros/etc/query.sql
2021-05-11 14:23:04.164021 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-11 14:23:04.166235 (MainThread): Parsing macros/etc/datetime.sql
2021-05-11 14:23:04.190305 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-11 14:23:04.193661 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-11 14:23:04.196152 (MainThread): Parsing macros/adapters/common.sql
2021-05-11 14:23:04.241506 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-11 14:23:04.243896 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-11 14:23:04.246040 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-11 14:23:04.248291 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-11 14:23:04.256619 (MainThread): Partial parsing not enabled
2021-05-11 14:23:04.281332 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-05-11 14:23:04.291855 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-05-11 14:23:04.296116 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-05-11 14:23:04.368554 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94b5792c-814e-4241-a305-bdda6dfb8fb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a1c55c7c0>]}
2021-05-11 14:23:04.391204 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94b5792c-814e-4241-a305-bdda6dfb8fb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a1c325e20>]}
2021-05-11 14:23:04.391496 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-11 14:23:04.392386 (MainThread): 
2021-05-11 14:23:04.392705 (MainThread): Acquiring new bigquery connection "master".
2021-05-11 14:23:04.393609 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_acquired-rite-313314".
2021-05-11 14:23:04.393849 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-11 14:23:04.757476 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_acquired-rite-313314_dbt_george".
2021-05-11 14:23:04.757699 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-11 14:23:04.763824 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-11 14:23:05.113453 (MainThread): 15:23:05 | Concurrency: 1 threads (target='dev')
2021-05-11 14:23:05.113646 (MainThread): 15:23:05 | 
2021-05-11 14:23:05.116049 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2021-05-11 14:23:05.116289 (Thread-1): 15:23:05 | 1 of 3 START table model dbt_george.my_first_dbt_model............... [RUN]
2021-05-11 14:23:05.116547 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-05-11 14:23:05.116658 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2021-05-11 14:23:05.118760 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-05-11 14:23:05.120138 (Thread-1): finished collecting timing info
2021-05-11 14:23:05.137253 (Thread-1): Opening a new connection, currently in state closed
2021-05-11 14:23:05.142693 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-11 14:23:05.484380 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-05-11 14:23:05.490761 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `acquired-rite-313314`.`dbt_george`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2021-05-11 14:23:07.594770 (Thread-1): finished collecting timing info
2021-05-11 14:23:07.595124 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94b5792c-814e-4241-a305-bdda6dfb8fb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a1c54ff10>]}
2021-05-11 14:23:07.595395 (Thread-1): 15:23:07 | 1 of 3 OK created table model dbt_george.my_first_dbt_model.......... [CREATE TABLE (2.0 rows, 0.0 Bytes processed) in 2.48s]
2021-05-11 14:23:07.595509 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2021-05-11 14:23:07.595620 (Thread-1): Began running node model.jaffle_shop.customers
2021-05-11 14:23:07.595869 (Thread-1): 15:23:07 | 2 of 3 START view model dbt_george.customers......................... [RUN]
2021-05-11 14:23:07.596197 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-05-11 14:23:07.596304 (Thread-1): Compiling model.jaffle_shop.customers
2021-05-11 14:23:07.598563 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2021-05-11 14:23:07.599998 (Thread-1): finished collecting timing info
2021-05-11 14:23:07.619360 (Thread-1): Opening a new connection, currently in state closed
2021-05-11 14:23:07.624703 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-11 14:23:08.143609 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2021-05-11 14:23:08.145045 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `acquired-rite-313314`.`dbt_george`.`customers`
  OPTIONS()
  as 

with customers as (

    select
        id as customer_id
        ...

)


with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2021-05-11 14:23:08.610325 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/acquired-rite-313314/queries/74f8836a-cfa0-4c53-aeb9-0676af800b33?maxResults=0&location=US&prettyPrint=false: Syntax error: Expected ")" but got "." at [12:9]')
2021-05-11 14:23:09.491004 (Thread-1): finished collecting timing info
2021-05-11 14:23:09.491352 (Thread-1): Database Error in model customers (models/customers.sql)
  Syntax error: Expected ")" but got "." at [12:9]
  compiled SQL at target/run/jaffle_shop/models/customers.sql
Traceback (most recent call last):
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 149, in exception_handler
    yield
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 534, in _retry_and_handle
    return retry.retry_target(
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/google/cloud/bigquery/job/query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/google/cloud/bigquery/job/base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/google/api_core/future/polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/google/cloud/bigquery/job/query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/google/api_core/future/polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/google/api_core/retry.py", line 281, in retry_wrapped_func
    return retry_target(
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/google/api_core/future/polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/google/cloud/bigquery/job/query.py", line 1022, in done
    self._query_results = self._client._get_query_results(
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/google/cloud/bigquery/client.py", line 1557, in _get_query_results
    resource = self._call_api(
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/google/cloud/bigquery/client.py", line 636, in _call_api
    return call()
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/google/api_core/retry.py", line 281, in retry_wrapped_func
    return retry_target(
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/google/cloud/_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/acquired-rite-313314/queries/a444cb22-32e4-4ada-a7e6-37dbbd29458f?maxResults=0&location=US&prettyPrint=false: Syntax error: Expected ")" but got "." at [12:9]

(job ID: a444cb22-32e4-4ada-a7e6-37dbbd29458f)

                                                         -----Query Job SQL Follows-----                                                         

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
   2:
   3:
   4:  create or replace view `acquired-rite-313314`.`dbt_george`.`customers`
   5:  OPTIONS()
   6:  as 
   7:
   8:with customers as (
   9:
  10:    select
  11:        id as customer_id
  12:        ...
  13:
  14:)
  15:
  16:
  17:with customers as (
  18:
  19:    select
  20:        id as customer_id,
  21:        first_name,
  22:        last_name
  23:
  24:    from `dbt-tutorial`.jaffle_shop.customers
  25:
  26:),
  27:
  28:orders as (
  29:
  30:    select
  31:        id as order_id,
  32:        user_id as customer_id,
  33:        order_date,
  34:        status
  35:
  36:    from `dbt-tutorial`.jaffle_shop.orders
  37:
  38:),
  39:
  40:customer_orders as (
  41:
  42:    select
  43:        customer_id,
  44:
  45:        min(order_date) as first_order_date,
  46:        max(order_date) as most_recent_order_date,
  47:        count(order_id) as number_of_orders
  48:
  49:    from orders
  50:
  51:    group by 1
  52:
  53:),
  54:
  55:
  56:final as (
  57:
  58:    select
  59:        customers.customer_id,
  60:        customers.first_name,
  61:        customers.last_name,
  62:        customer_orders.first_order_date,
  63:        customer_orders.most_recent_order_date,
  64:        coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  65:
  66:    from customers
  67:
  68:    left join customer_orders using (customer_id)
  69:
  70:)
  71:
  72:select * from final;
  73:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 534, in _retry_and_handle
    return retry.retry_target(
  File "/Users/georgefearnley/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  Syntax error: Expected ")" but got "." at [12:9]
  compiled SQL at target/run/jaffle_shop/models/customers.sql
2021-05-11 14:23:09.546435 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94b5792c-814e-4241-a305-bdda6dfb8fb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a1d1b6a90>]}
2021-05-11 14:23:09.546827 (Thread-1): 15:23:09 | 2 of 3 ERROR creating view model dbt_george.customers................ [ERROR in 1.95s]
2021-05-11 14:23:09.546963 (Thread-1): Finished running node model.jaffle_shop.customers
2021-05-11 14:23:09.547133 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2021-05-11 14:23:09.547570 (Thread-1): 15:23:09 | 3 of 3 START view model dbt_george.my_second_dbt_model............... [RUN]
2021-05-11 14:23:09.548197 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-05-11 14:23:09.548406 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2021-05-11 14:23:09.551808 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-05-11 14:23:09.553278 (Thread-1): finished collecting timing info
2021-05-11 14:23:09.556391 (Thread-1): unclosed <socket.socket fd=10, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:7d65:8782:3ca8:d975', 58134, 0, 0), raddr=('2a00:1450:4009:817::200a', 443, 0, 0)>
2021-05-11 14:23:09.556719 (Thread-1): unclosed <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:7d65:8782:3ca8:d975', 58135, 0, 0), raddr=('2a00:1450:4009:822::200a', 443, 0, 0)>
2021-05-11 14:23:09.556939 (Thread-1): unclosed <socket.socket fd=13, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:7d65:8782:3ca8:d975', 58137, 0, 0), raddr=('2a00:1450:4009:822::200a', 443, 0, 0)>
2021-05-11 14:23:09.557163 (Thread-1): unclosed <socket.socket fd=12, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:7d65:8782:3ca8:d975', 58136, 0, 0), raddr=('2a00:1450:4009:817::200a', 443, 0, 0)>
2021-05-11 14:23:09.557336 (Thread-1): unclosed <socket.socket fd=19, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:7d65:8782:3ca8:d975', 58139, 0, 0), raddr=('2a00:1450:4009:822::200a', 443, 0, 0)>
2021-05-11 14:23:09.557473 (Thread-1): unclosed <socket.socket fd=18, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:7d65:8782:3ca8:d975', 58138, 0, 0), raddr=('2a00:1450:4009:817::200a', 443, 0, 0)>
2021-05-11 14:23:09.557609 (Thread-1): unclosed <socket.socket fd=20, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:7d65:8782:3ca8:d975', 58140, 0, 0), raddr=('2a00:1450:4009:817::200a', 443, 0, 0)>
2021-05-11 14:23:09.557737 (Thread-1): unclosed <socket.socket fd=21, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:7d65:8782:3ca8:d975', 58141, 0, 0), raddr=('2a00:1450:4009:822::200a', 443, 0, 0)>
2021-05-11 14:23:09.558153 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-05-11 14:23:09.559417 (Thread-1): Opening a new connection, currently in state closed
2021-05-11 14:23:09.565212 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `acquired-rite-313314`.`dbt_george`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `acquired-rite-313314`.`dbt_george`.`my_first_dbt_model`
where id = 1;


2021-05-11 14:23:10.409072 (Thread-1): finished collecting timing info
2021-05-11 14:23:10.409440 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94b5792c-814e-4241-a305-bdda6dfb8fb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a1c531670>]}
2021-05-11 14:23:10.409732 (Thread-1): 15:23:10 | 3 of 3 OK created view model dbt_george.my_second_dbt_model.......... [OK in 0.86s]
2021-05-11 14:23:10.409855 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2021-05-11 14:23:10.410751 (MainThread): Acquiring new bigquery connection "master".
2021-05-11 14:23:10.411004 (MainThread): 15:23:10 | 
2021-05-11 14:23:10.411113 (MainThread): 15:23:10 | Finished running 1 table model, 2 view models in 6.02s.
2021-05-11 14:23:10.411204 (MainThread): Connection 'master' was properly closed.
2021-05-11 14:23:10.411269 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2021-05-11 14:23:10.411919 (MainThread): unclosed <socket.socket fd=10, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:7d65:8782:3ca8:d975', 58142, 0, 0), raddr=('2a00:1450:4009:817::200a', 443, 0, 0)>
2021-05-11 14:23:10.412053 (MainThread): unclosed <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:7d65:8782:3ca8:d975', 58143, 0, 0), raddr=('2a00:1450:4009:822::200a', 443, 0, 0)>
2021-05-11 14:23:10.417214 (MainThread): 
2021-05-11 14:23:10.417367 (MainThread): Completed with 1 error and 0 warnings:
2021-05-11 14:23:10.417468 (MainThread): 
2021-05-11 14:23:10.417563 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-11 14:23:10.417646 (MainThread):   Syntax error: Expected ")" but got "." at [12:9]
2021-05-11 14:23:10.417721 (MainThread):   compiled SQL at target/run/jaffle_shop/models/customers.sql
2021-05-11 14:23:10.417807 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-11 14:23:10.417952 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a1c527e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a1c4107c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a1c450ac0>]}
2021-05-11 14:23:10.418120 (MainThread): Flushing usage events
2021-05-11 14:25:26.266195 (MainThread): Running with dbt=0.19.1
2021-05-11 14:25:26.746786 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/georgefearnley/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-11 14:25:26.748250 (MainThread): Tracking: tracking
2021-05-11 14:25:26.757851 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaccf00e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcacce92460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcacce92400>]}
2021-05-11 14:25:26.770979 (MainThread): Partial parsing not enabled
2021-05-11 14:25:26.773105 (MainThread): Parsing macros/etc.sql
2021-05-11 14:25:26.792107 (MainThread): Parsing macros/catalog.sql
2021-05-11 14:25:26.799918 (MainThread): Parsing macros/adapters.sql
2021-05-11 14:25:26.820981 (MainThread): Parsing macros/materializations/seed.sql
2021-05-11 14:25:26.824329 (MainThread): Parsing macros/materializations/view.sql
2021-05-11 14:25:26.841960 (MainThread): Parsing macros/materializations/table.sql
2021-05-11 14:25:26.853615 (MainThread): Parsing macros/materializations/copy.sql
2021-05-11 14:25:26.858648 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-11 14:25:26.872420 (MainThread): Parsing macros/materializations/snapshot.sql
2021-05-11 14:25:26.891984 (MainThread): Parsing macros/core.sql
2021-05-11 14:25:26.896660 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-11 14:25:26.906322 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-11 14:25:26.908980 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-11 14:25:26.942178 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-11 14:25:26.992278 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-11 14:25:27.016423 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-11 14:25:27.019350 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-11 14:25:27.042407 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-11 14:25:27.060708 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-11 14:25:27.068559 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-11 14:25:27.092119 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-11 14:25:27.098300 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-11 14:25:27.099992 (MainThread): Parsing macros/etc/query.sql
2021-05-11 14:25:27.101746 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-11 14:25:27.104032 (MainThread): Parsing macros/etc/datetime.sql
2021-05-11 14:25:27.113452 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-11 14:25:27.116285 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-11 14:25:27.118573 (MainThread): Parsing macros/adapters/common.sql
2021-05-11 14:25:27.165149 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-11 14:25:27.167617 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-11 14:25:27.169875 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-11 14:25:27.172174 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-11 14:25:27.192270 (MainThread): Partial parsing not enabled
2021-05-11 14:25:27.216869 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-05-11 14:25:27.243253 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-05-11 14:25:27.247468 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-05-11 14:25:27.321228 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe41e384-b96b-45a9-82fa-00d70f24d6a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcacda9c6d0>]}
2021-05-11 14:25:27.345216 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe41e384-b96b-45a9-82fa-00d70f24d6a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaccf2d5b0>]}
2021-05-11 14:25:27.345499 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-11 14:25:27.346469 (MainThread): 
2021-05-11 14:25:27.346771 (MainThread): Acquiring new bigquery connection "master".
2021-05-11 14:25:27.347596 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_acquired-rite-313314".
2021-05-11 14:25:27.347805 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-11 14:25:27.722846 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_acquired-rite-313314_dbt_george".
2021-05-11 14:25:27.723044 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-11 14:25:27.728344 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-11 14:25:28.082406 (MainThread): 15:25:28 | Concurrency: 1 threads (target='dev')
2021-05-11 14:25:28.082645 (MainThread): 15:25:28 | 
2021-05-11 14:25:28.093507 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2021-05-11 14:25:28.093783 (Thread-1): 15:25:28 | 1 of 3 START table model dbt_george.my_first_dbt_model............... [RUN]
2021-05-11 14:25:28.094067 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-05-11 14:25:28.094185 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2021-05-11 14:25:28.096227 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-05-11 14:25:28.097609 (Thread-1): finished collecting timing info
2021-05-11 14:25:28.115169 (Thread-1): Opening a new connection, currently in state closed
2021-05-11 14:25:28.120827 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-11 14:25:28.461548 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-05-11 14:25:28.463033 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `acquired-rite-313314`.`dbt_george`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2021-05-11 14:25:30.570410 (Thread-1): finished collecting timing info
2021-05-11 14:25:30.570775 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe41e384-b96b-45a9-82fa-00d70f24d6a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcacd986160>]}
2021-05-11 14:25:30.571104 (Thread-1): 15:25:30 | 1 of 3 OK created table model dbt_george.my_first_dbt_model.......... [CREATE TABLE (2.0 rows, 0.0 Bytes processed) in 2.48s]
2021-05-11 14:25:30.571240 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2021-05-11 14:25:30.571378 (Thread-1): Began running node model.jaffle_shop.customers
2021-05-11 14:25:30.571665 (Thread-1): 15:25:30 | 2 of 3 START view model dbt_george.customers......................... [RUN]
2021-05-11 14:25:30.572002 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-05-11 14:25:30.572108 (Thread-1): Compiling model.jaffle_shop.customers
2021-05-11 14:25:30.573981 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2021-05-11 14:25:30.575155 (Thread-1): finished collecting timing info
2021-05-11 14:25:30.590508 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2021-05-11 14:25:30.592659 (Thread-1): Opening a new connection, currently in state closed
2021-05-11 14:25:30.597986 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `acquired-rite-313314`.`dbt_george`.`customers`
  OPTIONS()
  as 

with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2021-05-11 14:25:31.604097 (Thread-1): finished collecting timing info
2021-05-11 14:25:31.604489 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe41e384-b96b-45a9-82fa-00d70f24d6a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcacda1d340>]}
2021-05-11 14:25:31.604800 (Thread-1): 15:25:31 | 2 of 3 OK created view model dbt_george.customers.................... [OK in 1.03s]
2021-05-11 14:25:31.604935 (Thread-1): Finished running node model.jaffle_shop.customers
2021-05-11 14:25:31.605073 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2021-05-11 14:25:31.605349 (Thread-1): 15:25:31 | 3 of 3 START view model dbt_george.my_second_dbt_model............... [RUN]
2021-05-11 14:25:31.605624 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-05-11 14:25:31.605742 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2021-05-11 14:25:31.607709 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-05-11 14:25:31.609396 (Thread-1): finished collecting timing info
2021-05-11 14:25:31.611206 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-05-11 14:25:31.612518 (Thread-1): Opening a new connection, currently in state closed
2021-05-11 14:25:31.617893 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `acquired-rite-313314`.`dbt_george`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `acquired-rite-313314`.`dbt_george`.`my_first_dbt_model`
where id = 1;


2021-05-11 14:25:31.660252 (Thread-1): unclosed <socket.socket fd=10, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:7d65:8782:3ca8:d975', 58156, 0, 0), raddr=('2a00:1450:4009:817::200a', 443, 0, 0)>
2021-05-11 14:25:31.660446 (Thread-1): unclosed <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:7d65:8782:3ca8:d975', 58157, 0, 0), raddr=('2a00:1450:4009:822::200a', 443, 0, 0)>
2021-05-11 14:25:31.660565 (Thread-1): unclosed <socket.socket fd=13, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:7d65:8782:3ca8:d975', 58159, 0, 0), raddr=('2a00:1450:4009:822::200a', 443, 0, 0)>
2021-05-11 14:25:31.660693 (Thread-1): unclosed <socket.socket fd=12, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:7d65:8782:3ca8:d975', 58158, 0, 0), raddr=('2a00:1450:4009:817::200a', 443, 0, 0)>
2021-05-11 14:25:31.660815 (Thread-1): unclosed <socket.socket fd=19, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:7d65:8782:3ca8:d975', 58161, 0, 0), raddr=('2a00:1450:4009:822::200a', 443, 0, 0)>
2021-05-11 14:25:31.660933 (Thread-1): unclosed <socket.socket fd=18, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:7d65:8782:3ca8:d975', 58160, 0, 0), raddr=('2a00:1450:4009:817::200a', 443, 0, 0)>
2021-05-11 14:25:31.661050 (Thread-1): unclosed <socket.socket fd=20, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:7d65:8782:3ca8:d975', 58163, 0, 0), raddr=('2a00:1450:4009:817::200a', 443, 0, 0)>
2021-05-11 14:25:31.661170 (Thread-1): unclosed <socket.socket fd=21, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:7d65:8782:3ca8:d975', 58164, 0, 0), raddr=('2a00:1450:4009:822::200a', 443, 0, 0)>
2021-05-11 14:25:32.523189 (Thread-1): finished collecting timing info
2021-05-11 14:25:32.523601 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe41e384-b96b-45a9-82fa-00d70f24d6a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcacda99cd0>]}
2021-05-11 14:25:32.523917 (Thread-1): 15:25:32 | 3 of 3 OK created view model dbt_george.my_second_dbt_model.......... [OK in 0.92s]
2021-05-11 14:25:32.524062 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2021-05-11 14:25:32.525005 (MainThread): Acquiring new bigquery connection "master".
2021-05-11 14:25:32.525315 (MainThread): 15:25:32 | 
2021-05-11 14:25:32.525453 (MainThread): 15:25:32 | Finished running 1 table model, 2 view models in 5.18s.
2021-05-11 14:25:32.525572 (MainThread): Connection 'master' was properly closed.
2021-05-11 14:25:32.525643 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2021-05-11 14:25:32.544275 (MainThread): 
2021-05-11 14:25:32.544443 (MainThread): Completed successfully
2021-05-11 14:25:32.544555 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-05-11 14:25:32.544715 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcacda85bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcacda71550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcacda711f0>]}
2021-05-11 14:25:32.544892 (MainThread): Flushing usage events
2021-05-11 15:23:40.775556 (MainThread): Running with dbt=0.19.1
2021-05-11 15:23:41.783520 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/georgefearnley/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-11 15:23:41.786036 (MainThread): Tracking: tracking
2021-05-11 15:23:41.806042 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff742b0f2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff742aa0520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff742aa04c0>]}
2021-05-11 15:23:41.831581 (MainThread): Partial parsing not enabled
2021-05-11 15:23:41.833302 (MainThread): Parsing macros/etc.sql
2021-05-11 15:23:41.844094 (MainThread): Parsing macros/catalog.sql
2021-05-11 15:23:41.852244 (MainThread): Parsing macros/adapters.sql
2021-05-11 15:23:41.875944 (MainThread): Parsing macros/materializations/seed.sql
2021-05-11 15:23:41.879982 (MainThread): Parsing macros/materializations/view.sql
2021-05-11 15:23:41.884002 (MainThread): Parsing macros/materializations/table.sql
2021-05-11 15:23:41.895009 (MainThread): Parsing macros/materializations/copy.sql
2021-05-11 15:23:41.900681 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-11 15:23:41.926232 (MainThread): Parsing macros/materializations/snapshot.sql
2021-05-11 15:23:41.935441 (MainThread): Parsing macros/core.sql
2021-05-11 15:23:41.940548 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-11 15:23:41.951175 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-11 15:23:41.956711 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-11 15:23:41.976478 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-11 15:23:42.026648 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-11 15:23:42.049666 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-11 15:23:42.052853 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-11 15:23:42.076074 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-11 15:23:42.091535 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-11 15:23:42.099667 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-11 15:23:42.107422 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-11 15:23:42.126446 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-11 15:23:42.129200 (MainThread): Parsing macros/etc/query.sql
2021-05-11 15:23:42.131906 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-11 15:23:42.134621 (MainThread): Parsing macros/etc/datetime.sql
2021-05-11 15:23:42.144913 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-11 15:23:42.148029 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-11 15:23:42.151286 (MainThread): Parsing macros/adapters/common.sql
2021-05-11 15:23:42.198973 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-11 15:23:42.201836 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-11 15:23:42.204185 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-11 15:23:42.206845 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-11 15:23:42.225727 (MainThread): Partial parsing not enabled
2021-05-11 15:23:42.251762 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-05-11 15:23:42.276726 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-05-11 15:23:42.281895 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-05-11 15:23:42.336723 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dfd3180d-bc11-42e1-8a35-69b450d24045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff742d73580>]}
2021-05-11 15:23:42.347455 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dfd3180d-bc11-42e1-8a35-69b450d24045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff742cf8e50>]}
2021-05-11 15:23:42.347742 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-11 15:23:42.348442 (MainThread): 
2021-05-11 15:23:42.348718 (MainThread): Acquiring new bigquery connection "master".
2021-05-11 15:23:42.349520 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_acquired-rite-313314".
2021-05-11 15:23:42.349728 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-11 15:23:42.842521 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_acquired-rite-313314_dbt_george".
2021-05-11 15:23:42.842710 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-11 15:23:42.848261 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-11 15:23:43.190621 (MainThread): 16:23:43 | Concurrency: 1 threads (target='dev')
2021-05-11 15:23:43.190845 (MainThread): 16:23:43 | 
2021-05-11 15:23:43.198336 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-05-11 15:23:43.198624 (Thread-1): 16:23:43 | 1 of 3 START table model dbt_george.stg_customers.................... [RUN]
2021-05-11 15:23:43.198915 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-05-11 15:23:43.199031 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-05-11 15:23:43.200294 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-05-11 15:23:43.200779 (Thread-1): finished collecting timing info
2021-05-11 15:23:43.235871 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-05-11 15:23:43.236464 (Thread-1): Opening a new connection, currently in state closed
2021-05-11 15:23:43.241951 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace table `acquired-rite-313314`.`dbt_george`.`stg_customers`
  
  
  OPTIONS()
  as (
    select
    id as customer_id,
    first_name,
    last_name

from `dbt-tutorial`.jaffle_shop.customers
  );
    
2021-05-11 15:23:46.620604 (Thread-1): finished collecting timing info
2021-05-11 15:23:46.620971 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfd3180d-bc11-42e1-8a35-69b450d24045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff742c25430>]}
2021-05-11 15:23:46.621267 (Thread-1): 16:23:46 | 1 of 3 OK created table model dbt_george.stg_customers............... [CREATE TABLE (100.0 rows, 1.9 KB processed) in 3.42s]
2021-05-11 15:23:46.621388 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-05-11 15:23:46.621513 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-05-11 15:23:46.621784 (Thread-1): 16:23:46 | 2 of 3 START table model dbt_george.stg_orders....................... [RUN]
2021-05-11 15:23:46.622017 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-05-11 15:23:46.622119 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-05-11 15:23:46.622644 (Thread-1): unclosed <socket.socket fd=18, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:7d65:8782:3ca8:d975', 58643, 0, 0), raddr=('2a00:1450:4009:820::200a', 443, 0, 0)>
2021-05-11 15:23:46.622781 (Thread-1): unclosed <socket.socket fd=19, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:7d65:8782:3ca8:d975', 58644, 0, 0), raddr=('2a00:1450:4009:80a::200a', 443, 0, 0)>
2021-05-11 15:23:46.623540 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-05-11 15:23:46.623909 (Thread-1): finished collecting timing info
2021-05-11 15:23:46.625496 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-05-11 15:23:46.625832 (Thread-1): Opening a new connection, currently in state closed
2021-05-11 15:23:46.631033 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace table `acquired-rite-313314`.`dbt_george`.`stg_orders`
  
  
  OPTIONS()
  as (
    select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from `dbt-tutorial`.jaffle_shop.orders
  );
    
2021-05-11 15:23:48.627459 (Thread-1): finished collecting timing info
2021-05-11 15:23:48.627864 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfd3180d-bc11-42e1-8a35-69b450d24045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff742d3ef10>]}
2021-05-11 15:23:48.628382 (Thread-1): 16:23:48 | 2 of 3 OK created table model dbt_george.stg_orders.................. [CREATE TABLE (99.0 rows, 3.3 KB processed) in 2.01s]
2021-05-11 15:23:48.628532 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-05-11 15:23:48.629030 (Thread-1): Began running node model.jaffle_shop.customers
2021-05-11 15:23:48.629281 (Thread-1): 16:23:48 | 3 of 3 START table model dbt_george.customers........................ [RUN]
2021-05-11 15:23:48.629564 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-05-11 15:23:48.629666 (Thread-1): Compiling model.jaffle_shop.customers
2021-05-11 15:23:48.631809 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2021-05-11 15:23:48.633239 (Thread-1): finished collecting timing info
2021-05-11 15:23:48.634611 (Thread-1): Opening a new connection, currently in state closed
2021-05-11 15:23:48.639867 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-11 15:23:49.003762 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-11 15:23:49.217009 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2021-05-11 15:23:49.226151 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace table `acquired-rite-313314`.`dbt_george`.`customers`
  
  
  OPTIONS()
  as (
    with customers as (

    select * from `acquired-rite-313314`.`dbt_george`.`stg_customers`

),

orders as (

    select * from `acquired-rite-313314`.`dbt_george`.`stg_orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
    
2021-05-11 15:23:51.565381 (Thread-1): finished collecting timing info
2021-05-11 15:23:51.565759 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfd3180d-bc11-42e1-8a35-69b450d24045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff742e6a970>]}
2021-05-11 15:23:51.566083 (Thread-1): 16:23:51 | 3 of 3 OK created table model dbt_george.customers................... [CREATE TABLE (100.0 rows, 4.3 KB processed) in 2.94s]
2021-05-11 15:23:51.566208 (Thread-1): Finished running node model.jaffle_shop.customers
2021-05-11 15:23:51.567083 (MainThread): Acquiring new bigquery connection "master".
2021-05-11 15:23:51.567357 (MainThread): 16:23:51 | 
2021-05-11 15:23:51.567475 (MainThread): 16:23:51 | Finished running 3 table models in 9.22s.
2021-05-11 15:23:51.567572 (MainThread): Connection 'master' was properly closed.
2021-05-11 15:23:51.567642 (MainThread): Connection 'model.jaffle_shop.customers' was properly closed.
2021-05-11 15:23:51.582427 (MainThread): 
2021-05-11 15:23:51.582593 (MainThread): Completed successfully
2021-05-11 15:23:51.582704 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-05-11 15:23:51.582854 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff742c50d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff742d51b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff742d51ac0>]}
2021-05-11 15:23:51.583023 (MainThread): Flushing usage events
2021-05-11 15:42:33.548586 (MainThread): Running with dbt=0.19.1
2021-05-11 15:42:34.539859 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/georgefearnley/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-11 15:42:34.556183 (MainThread): Tracking: tracking
2021-05-11 15:42:34.587938 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904ea3f4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904e9d45b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904e9d4550>]}
2021-05-11 15:42:34.604721 (MainThread): Partial parsing not enabled
2021-05-11 15:42:34.624453 (MainThread): Parsing macros/etc.sql
2021-05-11 15:42:34.632716 (MainThread): Parsing macros/catalog.sql
2021-05-11 15:42:34.656618 (MainThread): Parsing macros/adapters.sql
2021-05-11 15:42:34.682257 (MainThread): Parsing macros/materializations/seed.sql
2021-05-11 15:42:34.686093 (MainThread): Parsing macros/materializations/view.sql
2021-05-11 15:42:34.690466 (MainThread): Parsing macros/materializations/table.sql
2021-05-11 15:42:34.701950 (MainThread): Parsing macros/materializations/copy.sql
2021-05-11 15:42:34.725328 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-11 15:42:34.741045 (MainThread): Parsing macros/materializations/snapshot.sql
2021-05-11 15:42:34.749575 (MainThread): Parsing macros/core.sql
2021-05-11 15:42:34.754608 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-11 15:42:34.775299 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-11 15:42:34.779039 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-11 15:42:34.799071 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-11 15:42:34.835326 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-11 15:42:34.857531 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-11 15:42:34.875012 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-11 15:42:34.882693 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-11 15:42:34.898347 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-11 15:42:34.907109 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-11 15:42:34.924835 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-11 15:42:34.931069 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-11 15:42:34.932881 (MainThread): Parsing macros/etc/query.sql
2021-05-11 15:42:34.934809 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-11 15:42:34.937363 (MainThread): Parsing macros/etc/datetime.sql
2021-05-11 15:42:34.947777 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-11 15:42:34.951038 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-11 15:42:34.954217 (MainThread): Parsing macros/adapters/common.sql
2021-05-11 15:42:35.000691 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-11 15:42:35.003450 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-11 15:42:35.005748 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-11 15:42:35.025309 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-11 15:42:35.033898 (MainThread): Partial parsing not enabled
2021-05-11 15:42:35.058572 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-05-11 15:42:35.075435 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-05-11 15:42:35.080794 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-05-11 15:42:35.137644 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c0cf0d0-f0e7-4985-bc53-0aff58b1e861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904eca36a0>]}
2021-05-11 15:42:35.148854 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c0cf0d0-f0e7-4985-bc53-0aff58b1e861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904eb91b20>]}
2021-05-11 15:42:35.149145 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-11 15:42:35.149889 (MainThread): 
2021-05-11 15:42:35.150240 (MainThread): Acquiring new bigquery connection "master".
2021-05-11 15:42:35.151245 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_acquired-rite-313314".
2021-05-11 15:42:35.151462 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-11 15:42:35.613372 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_acquired-rite-313314_dbt_george".
2021-05-11 15:42:35.613633 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-11 15:42:35.618993 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-11 15:42:35.943730 (MainThread): 16:42:35 | Concurrency: 1 threads (target='dev')
2021-05-11 15:42:35.943927 (MainThread): 16:42:35 | 
2021-05-11 15:42:35.950021 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-05-11 15:42:35.950287 (Thread-1): 16:42:35 | 1 of 3 START table model dbt_george.stg_customers.................... [RUN]
2021-05-11 15:42:35.950560 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-05-11 15:42:35.950672 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-05-11 15:42:35.951722 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-05-11 15:42:35.953564 (Thread-1): finished collecting timing info
2021-05-11 15:42:35.971276 (Thread-1): Opening a new connection, currently in state closed
2021-05-11 15:42:35.976660 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-11 15:42:36.323968 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-05-11 15:42:36.329154 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace table `acquired-rite-313314`.`dbt_george`.`stg_customers`
  
  
  OPTIONS()
  as (
    select
    id as customer_id,
    first_name,
    last_name

from `dbt-tutorial`.jaffle_shop.customers
  );
    
2021-05-11 15:42:39.353901 (Thread-1): finished collecting timing info
2021-05-11 15:42:39.354361 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c0cf0d0-f0e7-4985-bc53-0aff58b1e861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904eca3790>]}
2021-05-11 15:42:39.354744 (Thread-1): 16:42:39 | 1 of 3 OK created table model dbt_george.stg_customers............... [CREATE TABLE (100.0 rows, 1.9 KB processed) in 3.40s]
2021-05-11 15:42:39.354891 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-05-11 15:42:39.355029 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-05-11 15:42:39.355295 (Thread-1): 16:42:39 | 2 of 3 START table model dbt_george.stg_orders....................... [RUN]
2021-05-11 15:42:39.355549 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-05-11 15:42:39.355656 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-05-11 15:42:39.356893 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-05-11 15:42:39.376736 (Thread-1): finished collecting timing info
2021-05-11 15:42:39.378088 (Thread-1): Opening a new connection, currently in state closed
2021-05-11 15:42:39.383833 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-11 15:42:39.708759 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-05-11 15:42:39.726420 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace table `acquired-rite-313314`.`dbt_george`.`stg_orders`
  
  
  OPTIONS()
  as (
    select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from `dbt-tutorial`.jaffle_shop.orders
  );
    
2021-05-11 15:42:41.628819 (Thread-1): finished collecting timing info
2021-05-11 15:42:41.629174 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c0cf0d0-f0e7-4985-bc53-0aff58b1e861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904ec368b0>]}
2021-05-11 15:42:41.629453 (Thread-1): 16:42:41 | 2 of 3 OK created table model dbt_george.stg_orders.................. [CREATE TABLE (99.0 rows, 3.3 KB processed) in 2.27s]
2021-05-11 15:42:41.629574 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-05-11 15:42:41.630770 (Thread-1): Began running node model.jaffle_shop.customers
2021-05-11 15:42:41.631015 (Thread-1): 16:42:41 | 3 of 3 START table model dbt_george.customers........................ [RUN]
2021-05-11 15:42:41.631253 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-05-11 15:42:41.631352 (Thread-1): Compiling model.jaffle_shop.customers
2021-05-11 15:42:41.633701 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2021-05-11 15:42:41.635745 (Thread-1): finished collecting timing info
2021-05-11 15:42:41.637007 (Thread-1): Opening a new connection, currently in state closed
2021-05-11 15:42:41.642256 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-11 15:42:41.991115 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2021-05-11 15:42:41.993432 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace table `acquired-rite-313314`.`dbt_george`.`customers`
  
  
  OPTIONS()
  as (
    with customers as (

    select * from `acquired-rite-313314`.`dbt_george`.`stg_customers`

),

orders as (

    -- select * from `acquired-rite-313314`.`dbt_george`.`stg_orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
    
2021-05-11 15:42:42.534766 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/acquired-rite-313314/queries/2cb0dfaf-d43f-4142-a694-5314fb4b7776?maxResults=0&location=US&prettyPrint=false: Syntax error: Expected "(" or keyword SELECT or keyword WITH but got ")" at [19:1]')
2021-05-11 15:42:43.442060 (Thread-1): finished collecting timing info
2021-05-11 15:42:43.442529 (Thread-1): Database Error in model customers (models/customers.sql)
  Syntax error: Expected "(" or keyword SELECT or keyword WITH but got ")" at [19:1]
  compiled SQL at target/run/jaffle_shop/models/customers.sql
Traceback (most recent call last):
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 149, in exception_handler
    yield
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 534, in _retry_and_handle
    return retry.retry_target(
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/google/cloud/bigquery/job/query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/google/cloud/bigquery/job/base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/google/api_core/future/polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/google/cloud/bigquery/job/query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/google/api_core/future/polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/google/api_core/retry.py", line 281, in retry_wrapped_func
    return retry_target(
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/google/api_core/future/polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/google/cloud/bigquery/job/query.py", line 1022, in done
    self._query_results = self._client._get_query_results(
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/google/cloud/bigquery/client.py", line 1557, in _get_query_results
    resource = self._call_api(
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/google/cloud/bigquery/client.py", line 636, in _call_api
    return call()
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/google/api_core/retry.py", line 281, in retry_wrapped_func
    return retry_target(
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/google/cloud/_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/acquired-rite-313314/queries/9fdea2b5-2abb-4895-83d5-a4a0d9e9a48a?maxResults=0&location=US&prettyPrint=false: Syntax error: Expected "(" or keyword SELECT or keyword WITH but got ")" at [19:1]

(job ID: 9fdea2b5-2abb-4895-83d5-a4a0d9e9a48a)

                                                         -----Query Job SQL Follows-----                                                         

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
   2:
   3:
   4:  create or replace table `acquired-rite-313314`.`dbt_george`.`customers`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    with customers as (
  10:
  11:    select * from `acquired-rite-313314`.`dbt_george`.`stg_customers`
  12:
  13:),
  14:
  15:orders as (
  16:
  17:    -- select * from `acquired-rite-313314`.`dbt_george`.`stg_orders`
  18:
  19:),
  20:
  21:customer_orders as (
  22:
  23:    select
  24:        customer_id,
  25:
  26:        min(order_date) as first_order_date,
  27:        max(order_date) as most_recent_order_date,
  28:        count(order_id) as number_of_orders,
  29:
  30:    from orders
  31:
  32:    group by 1
  33:
  34:),
  35:
  36:
  37:final as (
  38:
  39:    select
  40:        customers.customer_id,
  41:        customers.first_name,
  42:        customers.last_name,
  43:        customer_orders.first_order_date,
  44:        customer_orders.most_recent_order_date,
  45:        coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  46:
  47:    from customers
  48:
  49:    left join customer_orders using (customer_id)
  50:
  51:)
  52:
  53:select * from final
  54:  );
  55:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 534, in _retry_and_handle
    return retry.retry_target(
  File "/Users/georgefearnley/opt/anaconda3/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/adapters/bigquery/connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models/customers.sql)
  Syntax error: Expected "(" or keyword SELECT or keyword WITH but got ")" at [19:1]
  compiled SQL at target/run/jaffle_shop/models/customers.sql
2021-05-11 15:42:43.504506 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c0cf0d0-f0e7-4985-bc53-0aff58b1e861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904ed33970>]}
2021-05-11 15:42:43.504807 (Thread-1): 16:42:43 | 3 of 3 ERROR creating table model dbt_george.customers............... [ERROR in 1.87s]
2021-05-11 15:42:43.504934 (Thread-1): Finished running node model.jaffle_shop.customers
2021-05-11 15:42:43.505855 (MainThread): Acquiring new bigquery connection "master".
2021-05-11 15:42:43.506168 (MainThread): 16:42:43 | 
2021-05-11 15:42:43.506282 (MainThread): 16:42:43 | Finished running 3 table models in 8.36s.
2021-05-11 15:42:43.506378 (MainThread): Connection 'master' was properly closed.
2021-05-11 15:42:43.506443 (MainThread): Connection 'model.jaffle_shop.customers' was properly closed.
2021-05-11 15:42:43.531073 (MainThread): 
2021-05-11 15:42:43.531237 (MainThread): Completed with 1 error and 0 warnings:
2021-05-11 15:42:43.531336 (MainThread): 
2021-05-11 15:42:43.531429 (MainThread): Database Error in model customers (models/customers.sql)
2021-05-11 15:42:43.531509 (MainThread):   Syntax error: Expected "(" or keyword SELECT or keyword WITH but got ")" at [19:1]
2021-05-11 15:42:43.531584 (MainThread):   compiled SQL at target/run/jaffle_shop/models/customers.sql
2021-05-11 15:42:43.531675 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-05-11 15:42:43.531848 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904eca0e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904eca0dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f904ec8cf40>]}
2021-05-11 15:42:43.532136 (MainThread): Flushing usage events
2021-05-11 15:46:24.952870 (MainThread): Running with dbt=0.19.1
2021-05-11 15:46:25.435918 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['customers'], partial_parse=None, profile=None, profiles_dir='/Users/georgefearnley/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-11 15:46:25.437836 (MainThread): Tracking: tracking
2021-05-11 15:46:25.447212 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93407fee80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9340792490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9340792430>]}
2021-05-11 15:46:25.459748 (MainThread): Partial parsing not enabled
2021-05-11 15:46:25.462171 (MainThread): Parsing macros/etc.sql
2021-05-11 15:46:25.482215 (MainThread): Parsing macros/catalog.sql
2021-05-11 15:46:25.489475 (MainThread): Parsing macros/adapters.sql
2021-05-11 15:46:25.510034 (MainThread): Parsing macros/materializations/seed.sql
2021-05-11 15:46:25.529959 (MainThread): Parsing macros/materializations/view.sql
2021-05-11 15:46:25.534284 (MainThread): Parsing macros/materializations/table.sql
2021-05-11 15:46:25.545119 (MainThread): Parsing macros/materializations/copy.sql
2021-05-11 15:46:25.549999 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-11 15:46:25.579686 (MainThread): Parsing macros/materializations/snapshot.sql
2021-05-11 15:46:25.585804 (MainThread): Parsing macros/core.sql
2021-05-11 15:46:25.590194 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-11 15:46:25.600546 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-11 15:46:25.603025 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-11 15:46:25.629930 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-11 15:46:25.679680 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-11 15:46:25.702114 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-11 15:46:25.704511 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-11 15:46:25.711449 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-11 15:46:25.729719 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-11 15:46:25.736995 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-11 15:46:25.743960 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-11 15:46:25.749562 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-11 15:46:25.750938 (MainThread): Parsing macros/etc/query.sql
2021-05-11 15:46:25.752482 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-11 15:46:25.754678 (MainThread): Parsing macros/etc/datetime.sql
2021-05-11 15:46:25.779622 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-11 15:46:25.782337 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-11 15:46:25.784550 (MainThread): Parsing macros/adapters/common.sql
2021-05-11 15:46:25.831387 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-11 15:46:25.833689 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-11 15:46:25.835694 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-11 15:46:25.837891 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-11 15:46:25.846371 (MainThread): Partial parsing not enabled
2021-05-11 15:46:25.870552 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-05-11 15:46:25.880837 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-05-11 15:46:25.885334 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-05-11 15:46:25.941370 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7eaf3045-6753-43bf-90c9-7c07ee6c569c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9340a635e0>]}
2021-05-11 15:46:25.946536 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7eaf3045-6753-43bf-90c9-7c07ee6c569c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9340964ac0>]}
2021-05-11 15:46:25.946767 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-11 15:46:25.947391 (MainThread): 
2021-05-11 15:46:25.947664 (MainThread): Acquiring new bigquery connection "master".
2021-05-11 15:46:25.948344 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_acquired-rite-313314".
2021-05-11 15:46:25.948547 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-11 15:46:26.393632 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_acquired-rite-313314_dbt_george".
2021-05-11 15:46:26.393896 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-11 15:46:26.400375 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-11 15:46:26.820307 (MainThread): 16:46:26 | Concurrency: 1 threads (target='dev')
2021-05-11 15:46:26.820482 (MainThread): 16:46:26 | 
2021-05-11 15:46:26.830947 (Thread-1): Began running node model.jaffle_shop.customers
2021-05-11 15:46:26.831254 (Thread-1): 16:46:26 | 1 of 1 START table model dbt_george.customers........................ [RUN]
2021-05-11 15:46:26.831539 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-05-11 15:46:26.831658 (Thread-1): Compiling model.jaffle_shop.customers
2021-05-11 15:46:26.833941 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2021-05-11 15:46:26.835524 (Thread-1): finished collecting timing info
2021-05-11 15:46:26.853306 (Thread-1): Opening a new connection, currently in state closed
2021-05-11 15:46:26.859117 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-11 15:46:27.205983 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2021-05-11 15:46:27.207172 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace table `acquired-rite-313314`.`dbt_george`.`customers`
  
  
  OPTIONS()
  as (
    with customers as (

    select * from `acquired-rite-313314`.`dbt_george`.`stg_customers`

),

orders as (

    select * from `acquired-rite-313314`.`dbt_george`.`stg_orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
    
2021-05-11 15:46:30.053719 (Thread-1): finished collecting timing info
2021-05-11 15:46:30.054138 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7eaf3045-6753-43bf-90c9-7c07ee6c569c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9340915100>]}
2021-05-11 15:46:30.054478 (Thread-1): 16:46:30 | 1 of 1 OK created table model dbt_george.customers................... [CREATE TABLE (100.0 rows, 4.3 KB processed) in 3.22s]
2021-05-11 15:46:30.054630 (Thread-1): Finished running node model.jaffle_shop.customers
2021-05-11 15:46:30.055649 (MainThread): Acquiring new bigquery connection "master".
2021-05-11 15:46:30.055939 (MainThread): 16:46:30 | 
2021-05-11 15:46:30.056075 (MainThread): 16:46:30 | Finished running 1 table model in 4.11s.
2021-05-11 15:46:30.056189 (MainThread): Connection 'master' was properly closed.
2021-05-11 15:46:30.056271 (MainThread): Connection 'model.jaffle_shop.customers' was properly closed.
2021-05-11 15:46:30.061219 (MainThread): 
2021-05-11 15:46:30.061392 (MainThread): Completed successfully
2021-05-11 15:46:30.061564 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-11 15:46:30.061773 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9340a2f250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f934082a280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9340a24a90>]}
2021-05-11 15:46:30.061967 (MainThread): Flushing usage events
2021-05-11 15:47:12.901506 (MainThread): Running with dbt=0.19.1
2021-05-11 15:47:13.384363 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['customers'], partial_parse=None, profile=None, profiles_dir='/Users/georgefearnley/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-11 15:47:13.386483 (MainThread): Tracking: tracking
2021-05-11 15:47:13.400136 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5ec87ef10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5ec810520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5ec8104c0>]}
2021-05-11 15:47:13.413823 (MainThread): Partial parsing not enabled
2021-05-11 15:47:13.441249 (MainThread): Parsing macros/etc.sql
2021-05-11 15:47:13.445181 (MainThread): Parsing macros/catalog.sql
2021-05-11 15:47:13.452597 (MainThread): Parsing macros/adapters.sql
2021-05-11 15:47:13.480795 (MainThread): Parsing macros/materializations/seed.sql
2021-05-11 15:47:13.484212 (MainThread): Parsing macros/materializations/view.sql
2021-05-11 15:47:13.487659 (MainThread): Parsing macros/materializations/table.sql
2021-05-11 15:47:13.498932 (MainThread): Parsing macros/materializations/copy.sql
2021-05-11 15:47:13.504027 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-11 15:47:13.530935 (MainThread): Parsing macros/materializations/snapshot.sql
2021-05-11 15:47:13.536360 (MainThread): Parsing macros/core.sql
2021-05-11 15:47:13.541447 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-11 15:47:13.550985 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-11 15:47:13.553256 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-11 15:47:13.580795 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-11 15:47:13.630841 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-11 15:47:13.653407 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-11 15:47:13.655904 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-11 15:47:13.663454 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-11 15:47:13.680732 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-11 15:47:13.688432 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-11 15:47:13.695272 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-11 15:47:13.700927 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-11 15:47:13.702457 (MainThread): Parsing macros/etc/query.sql
2021-05-11 15:47:13.704172 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-11 15:47:13.706761 (MainThread): Parsing macros/etc/datetime.sql
2021-05-11 15:47:13.731097 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-11 15:47:13.734393 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-11 15:47:13.736888 (MainThread): Parsing macros/adapters/common.sql
2021-05-11 15:47:13.782588 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-11 15:47:13.784872 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-11 15:47:13.786973 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-11 15:47:13.788970 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-11 15:47:13.797537 (MainThread): Partial parsing not enabled
2021-05-11 15:47:13.821528 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-05-11 15:47:13.831804 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-05-11 15:47:13.836822 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-05-11 15:47:13.886670 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5ecbd4820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5ecb50790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5ecb892b0>]}
2021-05-11 15:47:13.886901 (MainThread): Flushing usage events
2021-05-11 15:47:14.273849 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-05-11 15:47:14.274043 (MainThread): Encountered an error:
2021-05-11 15:47:14.274200 (MainThread): Compilation Error in model customers (models/customers.sql)
  Model 'model.jaffle_shop.customers' (models/customers.sql) depends on a node named 'stg_order' which was not found
2021-05-11 15:47:14.292924 (MainThread): Traceback (most recent call last):
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/parser/manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/parser/manifest.py", line 444, in load_all
    manifest = loader.create_manifest()
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/parser/manifest.py", line 422, in create_manifest
    self.process_manifest(manifest)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/parser/manifest.py", line 388, in process_manifest
    process_refs(manifest, project_name)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/parser/manifest.py", line 758, in process_refs
    _process_refs_for_node(manifest, current_project, node)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/parser/manifest.py", line 740, in _process_refs_for_node
    invalid_ref_fail_unless_test(
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/parser/manifest.py", line 483, in invalid_ref_fail_unless_test
    ref_target_not_found(
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/exceptions.py", line 566, in ref_target_not_found
    raise_compiler_error(msg, model)
  File "/Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/dbt-env/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model customers (models/customers.sql)
  Model 'model.jaffle_shop.customers' (models/customers.sql) depends on a node named 'stg_order' which was not found

2021-05-11 15:48:05.104737 (MainThread): Running with dbt=0.19.1
2021-05-11 15:48:05.586781 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['customers'], partial_parse=None, profile=None, profiles_dir='/Users/georgefearnley/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-11 15:48:05.588548 (MainThread): Tracking: tracking
2021-05-11 15:48:05.599816 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6aeb3e730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6aead5520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6aead54c0>]}
2021-05-11 15:48:05.612456 (MainThread): Partial parsing not enabled
2021-05-11 15:48:05.614966 (MainThread): Parsing macros/etc.sql
2021-05-11 15:48:05.634415 (MainThread): Parsing macros/catalog.sql
2021-05-11 15:48:05.641789 (MainThread): Parsing macros/adapters.sql
2021-05-11 15:48:05.662332 (MainThread): Parsing macros/materializations/seed.sql
2021-05-11 15:48:05.682148 (MainThread): Parsing macros/materializations/view.sql
2021-05-11 15:48:05.685587 (MainThread): Parsing macros/materializations/table.sql
2021-05-11 15:48:05.696799 (MainThread): Parsing macros/materializations/copy.sql
2021-05-11 15:48:05.701669 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-11 15:48:05.731891 (MainThread): Parsing macros/materializations/snapshot.sql
2021-05-11 15:48:05.737798 (MainThread): Parsing macros/core.sql
2021-05-11 15:48:05.742474 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-11 15:48:05.752191 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-11 15:48:05.754436 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-11 15:48:05.782273 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-11 15:48:05.832027 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-11 15:48:05.855327 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-11 15:48:05.857922 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-11 15:48:05.864699 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-11 15:48:05.881942 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-11 15:48:05.889699 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-11 15:48:05.897077 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-11 15:48:05.902936 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-11 15:48:05.904293 (MainThread): Parsing macros/etc/query.sql
2021-05-11 15:48:05.905993 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-11 15:48:05.908063 (MainThread): Parsing macros/etc/datetime.sql
2021-05-11 15:48:05.932097 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-11 15:48:05.935120 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-11 15:48:05.937586 (MainThread): Parsing macros/adapters/common.sql
2021-05-11 15:48:05.984598 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-11 15:48:05.986991 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-11 15:48:05.989023 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-11 15:48:05.991240 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-11 15:48:05.999471 (MainThread): Partial parsing not enabled
2021-05-11 15:48:06.040589 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-05-11 15:48:06.049936 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-05-11 15:48:06.054398 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-05-11 15:48:06.114469 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cbdbc4b6-3bf6-4a44-a754-2a9a3b99a715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6aeda0580>]}
2021-05-11 15:48:06.133812 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cbdbc4b6-3bf6-4a44-a754-2a9a3b99a715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6aed27dc0>]}
2021-05-11 15:48:06.134099 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-11 15:48:06.134740 (MainThread): 
2021-05-11 15:48:06.135028 (MainThread): Acquiring new bigquery connection "master".
2021-05-11 15:48:06.135757 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_acquired-rite-313314".
2021-05-11 15:48:06.135909 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-11 15:48:06.523026 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_acquired-rite-313314_dbt_george".
2021-05-11 15:48:06.523243 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-11 15:48:06.528488 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-11 15:48:06.930233 (MainThread): 16:48:06 | Concurrency: 1 threads (target='dev')
2021-05-11 15:48:06.930425 (MainThread): 16:48:06 | 
2021-05-11 15:48:06.933772 (Thread-1): Began running node model.jaffle_shop.customers
2021-05-11 15:48:06.934067 (Thread-1): 16:48:06 | 1 of 1 START table model dbt_george.customers........................ [RUN]
2021-05-11 15:48:06.934373 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-05-11 15:48:06.934490 (Thread-1): Compiling model.jaffle_shop.customers
2021-05-11 15:48:06.937072 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2021-05-11 15:48:06.938234 (Thread-1): finished collecting timing info
2021-05-11 15:48:06.956375 (Thread-1): Opening a new connection, currently in state closed
2021-05-11 15:48:06.961721 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-11 15:48:07.342755 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2021-05-11 15:48:07.349913 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace table `acquired-rite-313314`.`dbt_george`.`customers`
  
  
  OPTIONS()
  as (
    with customers as (

    select * from `acquired-rite-313314`.`dbt_george`.`stg_customers`

),

orders as (

    select * from `acquired-rite-313314`.`dbt_george`.`stg_orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
    
2021-05-11 15:48:09.737300 (Thread-1): finished collecting timing info
2021-05-11 15:48:09.737667 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbdbc4b6-3bf6-4a44-a754-2a9a3b99a715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6aecad850>]}
2021-05-11 15:48:09.737958 (Thread-1): 16:48:09 | 1 of 1 OK created table model dbt_george.customers................... [CREATE TABLE (100.0 rows, 4.3 KB processed) in 2.80s]
2021-05-11 15:48:09.738079 (Thread-1): Finished running node model.jaffle_shop.customers
2021-05-11 15:48:09.739043 (MainThread): Acquiring new bigquery connection "master".
2021-05-11 15:48:09.739329 (MainThread): 16:48:09 | 
2021-05-11 15:48:09.739465 (MainThread): 16:48:09 | Finished running 1 table model in 3.60s.
2021-05-11 15:48:09.739604 (MainThread): Connection 'master' was properly closed.
2021-05-11 15:48:09.739702 (MainThread): Connection 'model.jaffle_shop.customers' was properly closed.
2021-05-11 15:48:09.744760 (MainThread): 
2021-05-11 15:48:09.744903 (MainThread): Completed successfully
2021-05-11 15:48:09.745013 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-11 15:48:09.745166 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6aed64e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6aed64eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6aed33610>]}
2021-05-11 15:48:09.745333 (MainThread): Flushing usage events
2021-05-12 15:17:11.515473 (MainThread): Running with dbt=0.19.1
2021-05-12 15:17:12.434069 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/georgefearnley/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-05-12 15:17:12.444486 (MainThread): Tracking: tracking
2021-05-12 15:17:12.471153 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89ab8fe730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89ab890520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89ab8904c0>]}
2021-05-12 15:17:12.485408 (MainThread): Partial parsing not enabled
2021-05-12 15:17:12.487553 (MainThread): Parsing macros/etc.sql
2021-05-12 15:17:12.514405 (MainThread): Parsing macros/catalog.sql
2021-05-12 15:17:12.522897 (MainThread): Parsing macros/adapters.sql
2021-05-12 15:17:12.544874 (MainThread): Parsing macros/materializations/seed.sql
2021-05-12 15:17:12.563492 (MainThread): Parsing macros/materializations/view.sql
2021-05-12 15:17:12.568866 (MainThread): Parsing macros/materializations/table.sql
2021-05-12 15:17:12.581676 (MainThread): Parsing macros/materializations/copy.sql
2021-05-12 15:17:12.587482 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-12 15:17:12.613548 (MainThread): Parsing macros/materializations/snapshot.sql
2021-05-12 15:17:12.619664 (MainThread): Parsing macros/core.sql
2021-05-12 15:17:12.625129 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-12 15:17:12.635762 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-12 15:17:12.639157 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-12 15:17:12.664163 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-12 15:17:12.713847 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-12 15:17:12.736673 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-12 15:17:12.739498 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-12 15:17:12.763714 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-12 15:17:12.779712 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-12 15:17:12.788043 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-12 15:17:12.812733 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-12 15:17:12.819856 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-12 15:17:12.821696 (MainThread): Parsing macros/etc/query.sql
2021-05-12 15:17:12.823622 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-12 15:17:12.826201 (MainThread): Parsing macros/etc/datetime.sql
2021-05-12 15:17:12.837019 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-12 15:17:12.840301 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-12 15:17:12.843457 (MainThread): Parsing macros/adapters/common.sql
2021-05-12 15:17:12.890854 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-12 15:17:12.893767 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-12 15:17:12.912902 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-12 15:17:12.916159 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-12 15:17:12.924475 (MainThread): Partial parsing not enabled
2021-05-12 15:17:12.949568 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-05-12 15:17:12.963692 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-05-12 15:17:12.968479 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-05-12 15:17:13.074014 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55be9a5c-7bef-48e5-9af2-df460cc8572d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89abd67820>]}
2021-05-12 15:17:13.081289 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55be9a5c-7bef-48e5-9af2-df460cc8572d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89ab92d0d0>]}
2021-05-12 15:17:13.081551 (MainThread): Found 3 models, 9 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-12 15:17:13.082574 (MainThread): 
2021-05-12 15:17:13.082860 (MainThread): Acquiring new bigquery connection "master".
2021-05-12 15:17:13.084173 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_acquired-rite-313314_dbt_george".
2021-05-12 15:17:13.084355 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-12 15:17:13.100326 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-12 15:17:13.555631 (MainThread): 16:17:13 | Concurrency: 1 threads (target='dev')
2021-05-12 15:17:13.555797 (MainThread): 16:17:13 | 
2021-05-12 15:17:13.566735 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2021-05-12 15:17:13.566945 (Thread-1): 16:17:13 | 1 of 9 START test accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned [RUN]
2021-05-12 15:17:13.567197 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned".
2021-05-12 15:17:13.567303 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2021-05-12 15:17:13.577875 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned"
2021-05-12 15:17:13.578963 (Thread-1): finished collecting timing info
2021-05-12 15:17:13.579157 (Thread-1): Opening a new connection, currently in state closed
2021-05-12 15:17:13.584518 (Thread-1): On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned"} */

    
    




with all_values as (

    select distinct
        status as value_field

    from `acquired-rite-313314`.`dbt_george`.`stg_orders`

),

validation_errors as (

    select
        value_field

    from all_values
    where value_field not in (
        'placed','shipped','completed','return_pending','returned'
    )
)

select count(*) as validation_errors
from validation_errors



2021-05-12 15:17:15.906074 (Thread-1): finished collecting timing info
2021-05-12 15:17:15.906823 (Thread-1): 16:17:15 | 1 of 9 PASS accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned [PASS in 2.34s]
2021-05-12 15:17:15.907014 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2021-05-12 15:17:15.907129 (Thread-1): Began running node test.jaffle_shop.not_null_customers_customer_id
2021-05-12 15:17:15.907298 (Thread-1): 16:17:15 | 2 of 9 START test not_null_customers_customer_id..................... [RUN]
2021-05-12 15:17:15.907498 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_customers_customer_id".
2021-05-12 15:17:15.907586 (Thread-1): Compiling test.jaffle_shop.not_null_customers_customer_id
2021-05-12 15:17:15.908175 (Thread-1): unclosed <socket.socket fd=16, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:5134:cde0:9e85:d6f3', 54186, 0, 0), raddr=('2a00:1450:4009:815::200a', 443, 0, 0)>
2021-05-12 15:17:15.908342 (Thread-1): unclosed <socket.socket fd=17, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:5134:cde0:9e85:d6f3', 54187, 0, 0), raddr=('2a00:1450:4009:818::200a', 443, 0, 0)>
2021-05-12 15:17:15.914241 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id"
2021-05-12 15:17:15.914788 (Thread-1): finished collecting timing info
2021-05-12 15:17:15.914945 (Thread-1): Opening a new connection, currently in state closed
2021-05-12 15:17:15.919994 (Thread-1): On test.jaffle_shop.not_null_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_customers_customer_id"} */

    
    



select count(*) as validation_errors
from `acquired-rite-313314`.`dbt_george`.`customers`
where customer_id is null



2021-05-12 15:17:17.771055 (Thread-1): finished collecting timing info
2021-05-12 15:17:17.771609 (Thread-1): 16:17:17 | 2 of 9 PASS not_null_customers_customer_id........................... [PASS in 1.86s]
2021-05-12 15:17:17.771828 (Thread-1): Finished running node test.jaffle_shop.not_null_customers_customer_id
2021-05-12 15:17:17.772011 (Thread-1): Began running node test.jaffle_shop.not_null_stg_customers_customer_id
2021-05-12 15:17:17.772349 (Thread-1): 16:17:17 | 3 of 9 START test not_null_stg_customers_customer_id................. [RUN]
2021-05-12 15:17:17.772906 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id".
2021-05-12 15:17:17.773100 (Thread-1): Compiling test.jaffle_shop.not_null_stg_customers_customer_id
2021-05-12 15:17:17.776512 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id"
2021-05-12 15:17:17.776950 (Thread-1): finished collecting timing info
2021-05-12 15:17:17.777100 (Thread-1): Opening a new connection, currently in state closed
2021-05-12 15:17:17.782433 (Thread-1): On test.jaffle_shop.not_null_stg_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id"} */

    
    



select count(*) as validation_errors
from `acquired-rite-313314`.`dbt_george`.`stg_customers`
where customer_id is null



2021-05-12 15:17:19.305688 (Thread-1): finished collecting timing info
2021-05-12 15:17:19.306370 (Thread-1): 16:17:19 | 3 of 9 PASS not_null_stg_customers_customer_id....................... [PASS in 1.53s]
2021-05-12 15:17:19.306620 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id
2021-05-12 15:17:19.306957 (Thread-1): Began running node test.jaffle_shop.not_null_stg_orders_customer_id
2021-05-12 15:17:19.307285 (Thread-1): 16:17:19 | 4 of 9 START test not_null_stg_orders_customer_id.................... [RUN]
2021-05-12 15:17:19.307699 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_customer_id".
2021-05-12 15:17:19.307790 (Thread-1): Compiling test.jaffle_shop.not_null_stg_orders_customer_id
2021-05-12 15:17:19.308846 (Thread-1): unclosed <socket.socket fd=10, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:5134:cde0:9e85:d6f3', 54184, 0, 0), raddr=('2a00:1450:4009:815::200a', 443, 0, 0)>
2021-05-12 15:17:19.308985 (Thread-1): unclosed <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:5134:cde0:9e85:d6f3', 54185, 0, 0), raddr=('2a00:1450:4009:818::200a', 443, 0, 0)>
2021-05-12 15:17:19.312208 (Thread-1): unclosed <socket.socket fd=17, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:5134:cde0:9e85:d6f3', 54193, 0, 0), raddr=('2a00:1450:4009:818::200a', 443, 0, 0)>
2021-05-12 15:17:19.312358 (Thread-1): unclosed <socket.socket fd=16, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:5134:cde0:9e85:d6f3', 54192, 0, 0), raddr=('2a00:1450:4009:815::200a', 443, 0, 0)>
2021-05-12 15:17:19.312496 (Thread-1): unclosed <socket.socket fd=18, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:5134:cde0:9e85:d6f3', 54195, 0, 0), raddr=('2a00:1450:4009:815::200a', 443, 0, 0)>
2021-05-12 15:17:19.312610 (Thread-1): unclosed <socket.socket fd=19, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:5134:cde0:9e85:d6f3', 54196, 0, 0), raddr=('2a00:1450:4009:818::200a', 443, 0, 0)>
2021-05-12 15:17:19.315378 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_customer_id"
2021-05-12 15:17:19.315775 (Thread-1): finished collecting timing info
2021-05-12 15:17:19.315922 (Thread-1): Opening a new connection, currently in state closed
2021-05-12 15:17:19.321411 (Thread-1): On test.jaffle_shop.not_null_stg_orders_customer_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_customer_id"} */

    
    



select count(*) as validation_errors
from `acquired-rite-313314`.`dbt_george`.`stg_orders`
where customer_id is null



2021-05-12 15:17:20.761545 (Thread-1): finished collecting timing info
2021-05-12 15:17:20.761900 (Thread-1): 16:17:20 | 4 of 9 PASS not_null_stg_orders_customer_id.......................... [PASS in 1.45s]
2021-05-12 15:17:20.762028 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_orders_customer_id
2021-05-12 15:17:20.762148 (Thread-1): Began running node test.jaffle_shop.not_null_stg_orders_order_id
2021-05-12 15:17:20.762324 (Thread-1): 16:17:20 | 5 of 9 START test not_null_stg_orders_order_id....................... [RUN]
2021-05-12 15:17:20.762534 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_order_id".
2021-05-12 15:17:20.762628 (Thread-1): Compiling test.jaffle_shop.not_null_stg_orders_order_id
2021-05-12 15:17:20.765395 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id"
2021-05-12 15:17:20.765773 (Thread-1): finished collecting timing info
2021-05-12 15:17:20.765906 (Thread-1): Opening a new connection, currently in state closed
2021-05-12 15:17:20.771350 (Thread-1): On test.jaffle_shop.not_null_stg_orders_order_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id"} */

    
    



select count(*) as validation_errors
from `acquired-rite-313314`.`dbt_george`.`stg_orders`
where order_id is null



2021-05-12 15:17:22.092863 (Thread-1): finished collecting timing info
2021-05-12 15:17:22.093279 (Thread-1): 16:17:22 | 5 of 9 PASS not_null_stg_orders_order_id............................. [PASS in 1.33s]
2021-05-12 15:17:22.093526 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_orders_order_id
2021-05-12 15:17:22.093710 (Thread-1): Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_
2021-05-12 15:17:22.093906 (Thread-1): 16:17:22 | 6 of 9 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ [RUN]
2021-05-12 15:17:22.094357 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_".
2021-05-12 15:17:22.094492 (Thread-1): Compiling test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_
2021-05-12 15:17:22.102534 (Thread-1): Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_"
2021-05-12 15:17:22.102932 (Thread-1): finished collecting timing info
2021-05-12 15:17:22.103081 (Thread-1): Opening a new connection, currently in state closed
2021-05-12 15:17:22.108560 (Thread-1): On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_"} */

    
    




select count(*) as validation_errors
from (
    select customer_id as id from `acquired-rite-313314`.`dbt_george`.`stg_orders`
) as child
left join (
    select customer_id as id from `acquired-rite-313314`.`dbt_george`.`stg_customers`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-05-12 15:17:23.654142 (Thread-1): finished collecting timing info
2021-05-12 15:17:23.654581 (Thread-1): 16:17:23 | 6 of 9 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ [PASS in 1.56s]
2021-05-12 15:17:23.654741 (Thread-1): Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_
2021-05-12 15:17:23.654895 (Thread-1): Began running node test.jaffle_shop.unique_customers_customer_id
2021-05-12 15:17:23.655125 (Thread-1): 16:17:23 | 7 of 9 START test unique_customers_customer_id....................... [RUN]
2021-05-12 15:17:23.655479 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_customers_customer_id".
2021-05-12 15:17:23.655604 (Thread-1): Compiling test.jaffle_shop.unique_customers_customer_id
2021-05-12 15:17:23.656246 (Thread-1): unclosed <socket.socket fd=18, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:5134:cde0:9e85:d6f3', 54202, 0, 0), raddr=('2a00:1450:4009:815::200a', 443, 0, 0)>
2021-05-12 15:17:23.656387 (Thread-1): unclosed <socket.socket fd=19, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:5134:cde0:9e85:d6f3', 54203, 0, 0), raddr=('2a00:1450:4009:818::200a', 443, 0, 0)>
2021-05-12 15:17:23.662535 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id"
2021-05-12 15:17:23.662977 (Thread-1): finished collecting timing info
2021-05-12 15:17:23.663148 (Thread-1): Opening a new connection, currently in state closed
2021-05-12 15:17:23.668396 (Thread-1): On test.jaffle_shop.unique_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_customers_customer_id"} */

    
    



select count(*) as validation_errors
from (

    select
        customer_id

    from `acquired-rite-313314`.`dbt_george`.`customers`
    where customer_id is not null
    group by customer_id
    having count(*) > 1

) validation_errors



2021-05-12 15:17:25.261606 (Thread-1): finished collecting timing info
2021-05-12 15:17:25.261944 (Thread-1): 16:17:25 | 7 of 9 PASS unique_customers_customer_id............................. [PASS in 1.61s]
2021-05-12 15:17:25.262127 (Thread-1): Finished running node test.jaffle_shop.unique_customers_customer_id
2021-05-12 15:17:25.262336 (Thread-1): Began running node test.jaffle_shop.unique_stg_customers_customer_id
2021-05-12 15:17:25.262639 (Thread-1): 16:17:25 | 8 of 9 START test unique_stg_customers_customer_id................... [RUN]
2021-05-12 15:17:25.262886 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id".
2021-05-12 15:17:25.262976 (Thread-1): Compiling test.jaffle_shop.unique_stg_customers_customer_id
2021-05-12 15:17:25.266040 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id"
2021-05-12 15:17:25.266472 (Thread-1): finished collecting timing info
2021-05-12 15:17:25.266652 (Thread-1): Opening a new connection, currently in state closed
2021-05-12 15:17:25.271865 (Thread-1): On test.jaffle_shop.unique_stg_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id"} */

    
    



select count(*) as validation_errors
from (

    select
        customer_id

    from `acquired-rite-313314`.`dbt_george`.`stg_customers`
    where customer_id is not null
    group by customer_id
    having count(*) > 1

) validation_errors



2021-05-12 15:17:26.920047 (Thread-1): finished collecting timing info
2021-05-12 15:17:26.920852 (Thread-1): 16:17:26 | 8 of 9 PASS unique_stg_customers_customer_id......................... [PASS in 1.66s]
2021-05-12 15:17:26.921019 (Thread-1): Finished running node test.jaffle_shop.unique_stg_customers_customer_id
2021-05-12 15:17:26.921165 (Thread-1): Began running node test.jaffle_shop.unique_stg_orders_order_id
2021-05-12 15:17:26.921366 (Thread-1): 16:17:26 | 9 of 9 START test unique_stg_orders_order_id......................... [RUN]
2021-05-12 15:17:26.921628 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_orders_order_id".
2021-05-12 15:17:26.921739 (Thread-1): Compiling test.jaffle_shop.unique_stg_orders_order_id
2021-05-12 15:17:26.924939 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id"
2021-05-12 15:17:26.925327 (Thread-1): finished collecting timing info
2021-05-12 15:17:26.925462 (Thread-1): Opening a new connection, currently in state closed
2021-05-12 15:17:26.930623 (Thread-1): On test.jaffle_shop.unique_stg_orders_order_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id"} */

    
    



select count(*) as validation_errors
from (

    select
        order_id

    from `acquired-rite-313314`.`dbt_george`.`stg_orders`
    where order_id is not null
    group by order_id
    having count(*) > 1

) validation_errors



2021-05-12 15:17:28.443140 (Thread-1): finished collecting timing info
2021-05-12 15:17:28.443569 (Thread-1): 16:17:28 | 9 of 9 PASS unique_stg_orders_order_id............................... [PASS in 1.52s]
2021-05-12 15:17:28.443718 (Thread-1): Finished running node test.jaffle_shop.unique_stg_orders_order_id
2021-05-12 15:17:28.444942 (MainThread): Acquiring new bigquery connection "master".
2021-05-12 15:17:28.445236 (MainThread): 16:17:28 | 
2021-05-12 15:17:28.445366 (MainThread): 16:17:28 | Finished running 9 tests in 15.36s.
2021-05-12 15:17:28.445480 (MainThread): Connection 'master' was properly closed.
2021-05-12 15:17:28.445560 (MainThread): Connection 'test.jaffle_shop.unique_stg_orders_order_id' was properly closed.
2021-05-12 15:17:28.446582 (MainThread): unclosed <socket.socket fd=22, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:5134:cde0:9e85:d6f3', 54212, 0, 0), raddr=('2a00:1450:4009:815::200a', 443, 0, 0)>
2021-05-12 15:17:28.446768 (MainThread): unclosed <socket.socket fd=23, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:5134:cde0:9e85:d6f3', 54213, 0, 0), raddr=('2a00:1450:4009:818::200a', 443, 0, 0)>
2021-05-12 15:17:28.465101 (MainThread): 
2021-05-12 15:17:28.465311 (MainThread): Completed successfully
2021-05-12 15:17:28.465548 (MainThread): 
Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
2021-05-12 15:17:28.465735 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89abd84190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89abb4eb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89abb4efa0>]}
2021-05-12 15:17:28.465963 (MainThread): Flushing usage events
2021-05-12 15:51:34.483907 (MainThread): Running with dbt=0.19.1
2021-05-12 15:51:35.114212 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/georgefearnley/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2021-05-12 15:51:35.116921 (MainThread): Tracking: tracking
2021-05-12 15:51:35.128909 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4490fd3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe44908d4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe44908d490>]}
2021-05-12 15:51:35.162037 (MainThread): Partial parsing not enabled
2021-05-12 15:51:35.164219 (MainThread): Parsing macros/etc.sql
2021-05-12 15:51:35.168611 (MainThread): Parsing macros/catalog.sql
2021-05-12 15:51:35.175930 (MainThread): Parsing macros/adapters.sql
2021-05-12 15:51:35.206163 (MainThread): Parsing macros/materializations/seed.sql
2021-05-12 15:51:35.210441 (MainThread): Parsing macros/materializations/view.sql
2021-05-12 15:51:35.214280 (MainThread): Parsing macros/materializations/table.sql
2021-05-12 15:51:35.225474 (MainThread): Parsing macros/materializations/copy.sql
2021-05-12 15:51:35.231145 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-12 15:51:35.256069 (MainThread): Parsing macros/materializations/snapshot.sql
2021-05-12 15:51:35.263059 (MainThread): Parsing macros/core.sql
2021-05-12 15:51:35.267950 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-12 15:51:35.278348 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-12 15:51:35.280810 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-12 15:51:35.306139 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-12 15:51:35.356058 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-12 15:51:35.379179 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-12 15:51:35.381749 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-12 15:51:35.389133 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-12 15:51:35.405934 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-12 15:51:35.414300 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-12 15:51:35.421759 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-12 15:51:35.427408 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-12 15:51:35.429170 (MainThread): Parsing macros/etc/query.sql
2021-05-12 15:51:35.430894 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-12 15:51:35.433157 (MainThread): Parsing macros/etc/datetime.sql
2021-05-12 15:51:35.456093 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-12 15:51:35.458821 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-12 15:51:35.461505 (MainThread): Parsing macros/adapters/common.sql
2021-05-12 15:51:35.508412 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-12 15:51:35.511027 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-12 15:51:35.513224 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-12 15:51:35.515585 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-12 15:51:35.524605 (MainThread): Partial parsing not enabled
2021-05-12 15:51:35.565748 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-05-12 15:51:35.576046 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-05-12 15:51:35.581019 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-05-12 15:51:35.669454 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7f3be0d-04be-49d7-8802-820878a4b707', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe44954d0a0>]}
2021-05-12 15:51:35.675340 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7f3be0d-04be-49d7-8802-820878a4b707', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe44932b460>]}
2021-05-12 15:51:35.675583 (MainThread): Found 3 models, 7 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-12 15:51:35.676544 (MainThread): 
2021-05-12 15:51:35.676897 (MainThread): Acquiring new bigquery connection "master".
2021-05-12 15:51:35.678172 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_acquired-rite-313314_dbt_george".
2021-05-12 15:51:35.678396 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-12 15:51:35.685298 (ThreadPoolExecutor-0_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-12 15:51:36.183089 (MainThread): 16:51:36 | Concurrency: 1 threads (target='dev')
2021-05-12 15:51:36.183295 (MainThread): 16:51:36 | 
2021-05-12 15:51:36.186394 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-05-12 15:51:36.186830 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-05-12 15:51:36.186993 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-05-12 15:51:36.188287 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-05-12 15:51:36.207411 (Thread-1): finished collecting timing info
2021-05-12 15:51:36.207688 (Thread-1): finished collecting timing info
2021-05-12 15:51:36.208114 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-05-12 15:51:36.208332 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-05-12 15:51:36.208729 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-05-12 15:51:36.208985 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-05-12 15:51:36.210530 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-05-12 15:51:36.212002 (Thread-1): finished collecting timing info
2021-05-12 15:51:36.212239 (Thread-1): finished collecting timing info
2021-05-12 15:51:36.212585 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-05-12 15:51:36.212736 (Thread-1): Began running node test.jaffle_shop.not_null_stg_customers_customer_id
2021-05-12 15:51:36.213253 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id".
2021-05-12 15:51:36.213387 (Thread-1): Compiling test.jaffle_shop.not_null_stg_customers_customer_id
2021-05-12 15:51:36.220425 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id"
2021-05-12 15:51:36.221910 (Thread-1): finished collecting timing info
2021-05-12 15:51:36.222125 (Thread-1): finished collecting timing info
2021-05-12 15:51:36.222491 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id
2021-05-12 15:51:36.222661 (Thread-1): Began running node test.jaffle_shop.unique_stg_customers_customer_id
2021-05-12 15:51:36.223003 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id".
2021-05-12 15:51:36.223117 (Thread-1): Compiling test.jaffle_shop.unique_stg_customers_customer_id
2021-05-12 15:51:36.230149 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id"
2021-05-12 15:51:36.231253 (Thread-1): finished collecting timing info
2021-05-12 15:51:36.231491 (Thread-1): finished collecting timing info
2021-05-12 15:51:36.231910 (Thread-1): Finished running node test.jaffle_shop.unique_stg_customers_customer_id
2021-05-12 15:51:36.232063 (Thread-1): Began running node model.jaffle_shop.customers
2021-05-12 15:51:36.232447 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-05-12 15:51:36.232586 (Thread-1): Compiling model.jaffle_shop.customers
2021-05-12 15:51:36.235218 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2021-05-12 15:51:36.236526 (Thread-1): finished collecting timing info
2021-05-12 15:51:36.236783 (Thread-1): finished collecting timing info
2021-05-12 15:51:36.237280 (Thread-1): Finished running node model.jaffle_shop.customers
2021-05-12 15:51:36.237431 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2021-05-12 15:51:36.237805 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned".
2021-05-12 15:51:36.238046 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2021-05-12 15:51:36.248756 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned"
2021-05-12 15:51:36.256224 (Thread-1): finished collecting timing info
2021-05-12 15:51:36.256388 (Thread-1): finished collecting timing info
2021-05-12 15:51:36.256737 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2021-05-12 15:51:36.256874 (Thread-1): Began running node test.jaffle_shop.not_null_stg_orders_order_id
2021-05-12 15:51:36.257174 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_order_id".
2021-05-12 15:51:36.257279 (Thread-1): Compiling test.jaffle_shop.not_null_stg_orders_order_id
2021-05-12 15:51:36.260175 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id"
2021-05-12 15:51:36.261423 (Thread-1): finished collecting timing info
2021-05-12 15:51:36.261564 (Thread-1): finished collecting timing info
2021-05-12 15:51:36.261836 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_orders_order_id
2021-05-12 15:51:36.261971 (Thread-1): Began running node test.jaffle_shop.unique_stg_orders_order_id
2021-05-12 15:51:36.262294 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_orders_order_id".
2021-05-12 15:51:36.262406 (Thread-1): Compiling test.jaffle_shop.unique_stg_orders_order_id
2021-05-12 15:51:36.265125 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id"
2021-05-12 15:51:36.265990 (Thread-1): finished collecting timing info
2021-05-12 15:51:36.266120 (Thread-1): finished collecting timing info
2021-05-12 15:51:36.266367 (Thread-1): Finished running node test.jaffle_shop.unique_stg_orders_order_id
2021-05-12 15:51:36.266495 (Thread-1): Began running node test.jaffle_shop.not_null_customers_customer_id
2021-05-12 15:51:36.266786 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_customers_customer_id".
2021-05-12 15:51:36.266885 (Thread-1): Compiling test.jaffle_shop.not_null_customers_customer_id
2021-05-12 15:51:36.267858 (Thread-1): unclosed <socket.socket fd=10, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:5134:cde0:9e85:d6f3', 54474, 0, 0), raddr=('2a00:1450:4009:823::200a', 443, 0, 0)>
2021-05-12 15:51:36.268021 (Thread-1): unclosed <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:5134:cde0:9e85:d6f3', 54475, 0, 0), raddr=('2a00:1450:4009:819::200a', 443, 0, 0)>
2021-05-12 15:51:36.270886 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id"
2021-05-12 15:51:36.272045 (Thread-1): finished collecting timing info
2021-05-12 15:51:36.272201 (Thread-1): finished collecting timing info
2021-05-12 15:51:36.272531 (Thread-1): Finished running node test.jaffle_shop.not_null_customers_customer_id
2021-05-12 15:51:36.272710 (Thread-1): Began running node test.jaffle_shop.unique_customers_customer_id
2021-05-12 15:51:36.273006 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_customers_customer_id".
2021-05-12 15:51:36.273108 (Thread-1): Compiling test.jaffle_shop.unique_customers_customer_id
2021-05-12 15:51:36.276177 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id"
2021-05-12 15:51:36.277441 (Thread-1): finished collecting timing info
2021-05-12 15:51:36.277606 (Thread-1): finished collecting timing info
2021-05-12 15:51:36.277892 (Thread-1): Finished running node test.jaffle_shop.unique_customers_customer_id
2021-05-12 15:51:36.278726 (MainThread): Connection 'master' was properly closed.
2021-05-12 15:51:36.278831 (MainThread): Connection 'test.jaffle_shop.unique_customers_customer_id' was properly closed.
2021-05-12 15:51:36.284461 (MainThread): 16:51:36 | Done.
2021-05-12 15:51:36.423862 (MainThread): Acquiring new bigquery connection "generate_catalog".
2021-05-12 15:51:36.423997 (MainThread): 16:51:36 | Building catalog
2021-05-12 15:51:36.424794 (MainThread): Opening a new connection, currently in state init
2021-05-12 15:51:37.035628 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "acquired-rite-313314.information_schema".
2021-05-12 15:51:37.050812 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-12 15:51:37.056446 (ThreadPoolExecutor-1_0): On acquired-rite-313314.information_schema: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "acquired-rite-313314.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `acquired-rite-313314`.`dbt_george`.__TABLES__
        where (upper(dataset_id) = upper('dbt_george'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `acquired-rite-313314`.`dbt_george`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `acquired-rite-313314`.`dbt_george`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
2021-05-12 15:51:40.337581 (MainThread): 16:51:40 | Catalog written to /Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/target/catalog.json
2021-05-12 15:51:40.337812 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4490fd3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4497394c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4497392e0>]}
2021-05-12 15:51:40.338048 (MainThread): Flushing usage events
2021-05-12 15:51:40.762363 (MainThread): Connection 'generate_catalog' was properly closed.
2021-05-12 15:51:40.762620 (MainThread): Connection 'acquired-rite-313314.information_schema' was properly closed.
2021-05-12 15:51:51.658945 (MainThread): Running with dbt=0.19.1
2021-05-12 15:51:52.160987 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', open_browser=True, partial_parse=None, port=8080, profile=None, profiles_dir='/Users/georgefearnley/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='serve', write_json=True)
2021-05-12 15:51:52.163328 (MainThread): Tracking: tracking
2021-05-12 15:51:52.174509 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8e6efe580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8e6e8d550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8e6e8d4f0>]}
2021-05-12 15:51:52.178006 (MainThread): Serving docs at 0.0.0.0:8080
2021-05-12 15:51:52.178291 (MainThread): To access from your browser, navigate to:  http://localhost:8080
2021-05-12 15:51:52.178399 (MainThread): Press Ctrl+C to exit.


2021-05-12 15:52:39.662251 (MainThread): Flushing usage events
2021-05-12 15:52:40.052477 (MainThread): ctrl-c
2021-05-12 16:00:09.685452 (MainThread): Running with dbt=0.19.1
2021-05-12 16:00:10.311834 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/georgefearnley/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-05-12 16:00:10.314244 (MainThread): Tracking: tracking
2021-05-12 16:00:10.327516 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb0593e580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb058ce4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb058ce460>]}
2021-05-12 16:00:10.358219 (MainThread): Partial parsing not enabled
2021-05-12 16:00:10.360542 (MainThread): Parsing macros/etc.sql
2021-05-12 16:00:10.364838 (MainThread): Parsing macros/catalog.sql
2021-05-12 16:00:10.372096 (MainThread): Parsing macros/adapters.sql
2021-05-12 16:00:10.407366 (MainThread): Parsing macros/materializations/seed.sql
2021-05-12 16:00:10.410941 (MainThread): Parsing macros/materializations/view.sql
2021-05-12 16:00:10.414447 (MainThread): Parsing macros/materializations/table.sql
2021-05-12 16:00:10.425301 (MainThread): Parsing macros/materializations/copy.sql
2021-05-12 16:00:10.431008 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-12 16:00:10.457389 (MainThread): Parsing macros/materializations/snapshot.sql
2021-05-12 16:00:10.462991 (MainThread): Parsing macros/core.sql
2021-05-12 16:00:10.467615 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-12 16:00:10.478069 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-12 16:00:10.480713 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-12 16:00:10.507386 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-12 16:00:10.557281 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-12 16:00:10.579916 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-12 16:00:10.582497 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-12 16:00:10.589514 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-12 16:00:10.607194 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-12 16:00:10.615076 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-12 16:00:10.622069 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-12 16:00:10.627201 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-12 16:00:10.628983 (MainThread): Parsing macros/etc/query.sql
2021-05-12 16:00:10.630740 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-12 16:00:10.632704 (MainThread): Parsing macros/etc/datetime.sql
2021-05-12 16:00:10.657337 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-12 16:00:10.660107 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-12 16:00:10.662717 (MainThread): Parsing macros/adapters/common.sql
2021-05-12 16:00:10.710963 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-12 16:00:10.713457 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-12 16:00:10.715600 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-12 16:00:10.717815 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-12 16:00:10.727795 (MainThread): Partial parsing not enabled
2021-05-12 16:00:10.765627 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-05-12 16:00:10.775617 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-05-12 16:00:10.780355 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-05-12 16:00:10.870700 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef268b4c-02d7-4615-8f95-9d4abcea1a82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb05b8e130>]}
2021-05-12 16:00:10.876700 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef268b4c-02d7-4615-8f95-9d4abcea1a82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb059625b0>]}
2021-05-12 16:00:10.876932 (MainThread): Found 3 models, 7 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-12 16:00:10.877896 (MainThread): 
2021-05-12 16:00:10.878171 (MainThread): Acquiring new bigquery connection "master".
2021-05-12 16:00:10.879494 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_acquired-rite-313314_dbt_george".
2021-05-12 16:00:10.879683 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-12 16:00:10.886299 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-12 16:00:11.300956 (MainThread): 17:00:11 | Concurrency: 1 threads (target='dev')
2021-05-12 16:00:11.301167 (MainThread): 17:00:11 | 
2021-05-12 16:00:11.309267 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending
2021-05-12 16:00:11.309467 (Thread-1): 17:00:11 | 1 of 7 START test accepted_values_stg_orders_status__placed__shipped__completed__return_pending [RUN]
2021-05-12 16:00:11.309773 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending".
2021-05-12 16:00:11.309887 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending
2021-05-12 16:00:11.319259 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending"
2021-05-12 16:00:11.319793 (Thread-1): finished collecting timing info
2021-05-12 16:00:11.319961 (Thread-1): Opening a new connection, currently in state closed
2021-05-12 16:00:11.325128 (Thread-1): On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending"} */

    
    




with all_values as (

    select distinct
        status as value_field

    from `acquired-rite-313314`.`dbt_george`.`stg_orders`

),

validation_errors as (

    select
        value_field

    from all_values
    where value_field not in (
        'placed','shipped','completed','return_pending'
    )
)

select count(*) as validation_errors
from validation_errors



2021-05-12 16:00:13.679585 (Thread-1): finished collecting timing info
2021-05-12 16:00:13.680375 (Thread-1): 17:00:13 | 1 of 7 FAIL 1 accepted_values_stg_orders_status__placed__shipped__completed__return_pending [FAIL 1 in 2.37s]
2021-05-12 16:00:13.680536 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending
2021-05-12 16:00:13.680667 (Thread-1): Began running node test.jaffle_shop.not_null_customers_customer_id
2021-05-12 16:00:13.680877 (Thread-1): 17:00:13 | 2 of 7 START test not_null_customers_customer_id..................... [RUN]
2021-05-12 16:00:13.681283 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_customers_customer_id".
2021-05-12 16:00:13.681396 (Thread-1): Compiling test.jaffle_shop.not_null_customers_customer_id
2021-05-12 16:00:13.682003 (Thread-1): unclosed <socket.socket fd=16, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:5134:cde0:9e85:d6f3', 54571, 0, 0), raddr=('2a00:1450:4009:823::200a', 443, 0, 0)>
2021-05-12 16:00:13.682168 (Thread-1): unclosed <socket.socket fd=17, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:5134:cde0:9e85:d6f3', 54572, 0, 0), raddr=('2a00:1450:4009:823::200a', 443, 0, 0)>
2021-05-12 16:00:13.687813 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id"
2021-05-12 16:00:13.689371 (Thread-1): finished collecting timing info
2021-05-12 16:00:13.689543 (Thread-1): Opening a new connection, currently in state closed
2021-05-12 16:00:13.694739 (Thread-1): On test.jaffle_shop.not_null_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_customers_customer_id"} */

    
    



select count(*) as validation_errors
from `acquired-rite-313314`.`dbt_george`.`customers`
where customer_id is null



2021-05-12 16:00:15.019273 (Thread-1): finished collecting timing info
2021-05-12 16:00:15.019668 (Thread-1): 17:00:15 | 2 of 7 PASS not_null_customers_customer_id........................... [PASS in 1.34s]
2021-05-12 16:00:15.019796 (Thread-1): Finished running node test.jaffle_shop.not_null_customers_customer_id
2021-05-12 16:00:15.019946 (Thread-1): Began running node test.jaffle_shop.not_null_stg_customers_customer_id
2021-05-12 16:00:15.020127 (Thread-1): 17:00:15 | 3 of 7 START test not_null_stg_customers_customer_id................. [RUN]
2021-05-12 16:00:15.020348 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id".
2021-05-12 16:00:15.020454 (Thread-1): Compiling test.jaffle_shop.not_null_stg_customers_customer_id
2021-05-12 16:00:15.023492 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id"
2021-05-12 16:00:15.024670 (Thread-1): finished collecting timing info
2021-05-12 16:00:15.024816 (Thread-1): Opening a new connection, currently in state closed
2021-05-12 16:00:15.029964 (Thread-1): On test.jaffle_shop.not_null_stg_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id"} */

    
    



select count(*) as validation_errors
from `acquired-rite-313314`.`dbt_george`.`stg_customers`
where customer_id is null



2021-05-12 16:00:16.338060 (Thread-1): finished collecting timing info
2021-05-12 16:00:16.338683 (Thread-1): 17:00:16 | 3 of 7 PASS not_null_stg_customers_customer_id....................... [PASS in 1.32s]
2021-05-12 16:00:16.338962 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id
2021-05-12 16:00:16.339184 (Thread-1): Began running node test.jaffle_shop.not_null_stg_orders_order_id
2021-05-12 16:00:16.339373 (Thread-1): 17:00:16 | 4 of 7 START test not_null_stg_orders_order_id....................... [RUN]
2021-05-12 16:00:16.339826 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_order_id".
2021-05-12 16:00:16.339991 (Thread-1): Compiling test.jaffle_shop.not_null_stg_orders_order_id
2021-05-12 16:00:16.341200 (Thread-1): unclosed <socket.socket fd=18, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:5134:cde0:9e85:d6f3', 54581, 0, 0), raddr=('2a00:1450:4009:823::200a', 443, 0, 0)>
2021-05-12 16:00:16.341396 (Thread-1): unclosed <socket.socket fd=19, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:5134:cde0:9e85:d6f3', 54582, 0, 0), raddr=('2a00:1450:4009:823::200a', 443, 0, 0)>
2021-05-12 16:00:16.344025 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id"
2021-05-12 16:00:16.357773 (Thread-1): finished collecting timing info
2021-05-12 16:00:16.357971 (Thread-1): Opening a new connection, currently in state closed
2021-05-12 16:00:16.363215 (Thread-1): On test.jaffle_shop.not_null_stg_orders_order_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id"} */

    
    



select count(*) as validation_errors
from `acquired-rite-313314`.`dbt_george`.`stg_orders`
where order_id is null



2021-05-12 16:00:17.581695 (Thread-1): finished collecting timing info
2021-05-12 16:00:17.582110 (Thread-1): 17:00:17 | 4 of 7 PASS not_null_stg_orders_order_id............................. [PASS in 1.24s]
2021-05-12 16:00:17.582257 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_orders_order_id
2021-05-12 16:00:17.582399 (Thread-1): Began running node test.jaffle_shop.unique_customers_customer_id
2021-05-12 16:00:17.582534 (Thread-1): 17:00:17 | 5 of 7 START test unique_customers_customer_id....................... [RUN]
2021-05-12 16:00:17.582878 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_customers_customer_id".
2021-05-12 16:00:17.583009 (Thread-1): Compiling test.jaffle_shop.unique_customers_customer_id
2021-05-12 16:00:17.583650 (Thread-1): unclosed <socket.socket fd=18, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:5134:cde0:9e85:d6f3', 54584, 0, 0), raddr=('2a00:1450:4009:823::200a', 443, 0, 0)>
2021-05-12 16:00:17.583808 (Thread-1): unclosed <socket.socket fd=19, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:5134:cde0:9e85:d6f3', 54585, 0, 0), raddr=('2a00:1450:4009:823::200a', 443, 0, 0)>
2021-05-12 16:00:17.590374 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id"
2021-05-12 16:00:17.607903 (Thread-1): finished collecting timing info
2021-05-12 16:00:17.608133 (Thread-1): Opening a new connection, currently in state closed
2021-05-12 16:00:17.613390 (Thread-1): On test.jaffle_shop.unique_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_customers_customer_id"} */

    
    



select count(*) as validation_errors
from (

    select
        customer_id

    from `acquired-rite-313314`.`dbt_george`.`customers`
    where customer_id is not null
    group by customer_id
    having count(*) > 1

) validation_errors



2021-05-12 16:00:17.614583 (Thread-1): unclosed <socket.socket fd=10, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:5134:cde0:9e85:d6f3', 54569, 0, 0), raddr=('2a00:1450:4009:823::200a', 443, 0, 0)>
2021-05-12 16:00:17.614723 (Thread-1): unclosed <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:5134:cde0:9e85:d6f3', 54570, 0, 0), raddr=('2a00:1450:4009:823::200a', 443, 0, 0)>
2021-05-12 16:00:17.618367 (Thread-1): unclosed <socket.socket fd=16, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:5134:cde0:9e85:d6f3', 54578, 0, 0), raddr=('2a00:1450:4009:823::200a', 443, 0, 0)>
2021-05-12 16:00:17.618611 (Thread-1): unclosed <socket.socket fd=17, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:5134:cde0:9e85:d6f3', 54580, 0, 0), raddr=('2a00:1450:4009:823::200a', 443, 0, 0)>
2021-05-12 16:00:18.879865 (Thread-1): finished collecting timing info
2021-05-12 16:00:18.880361 (Thread-1): 17:00:18 | 5 of 7 PASS unique_customers_customer_id............................. [PASS in 1.30s]
2021-05-12 16:00:18.880541 (Thread-1): Finished running node test.jaffle_shop.unique_customers_customer_id
2021-05-12 16:00:18.880715 (Thread-1): Began running node test.jaffle_shop.unique_stg_customers_customer_id
2021-05-12 16:00:18.880880 (Thread-1): 17:00:18 | 6 of 7 START test unique_stg_customers_customer_id................... [RUN]
2021-05-12 16:00:18.881284 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id".
2021-05-12 16:00:18.881438 (Thread-1): Compiling test.jaffle_shop.unique_stg_customers_customer_id
2021-05-12 16:00:18.884907 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id"
2021-05-12 16:00:18.886131 (Thread-1): finished collecting timing info
2021-05-12 16:00:18.886307 (Thread-1): Opening a new connection, currently in state closed
2021-05-12 16:00:18.891815 (Thread-1): On test.jaffle_shop.unique_stg_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id"} */

    
    



select count(*) as validation_errors
from (

    select
        customer_id

    from `acquired-rite-313314`.`dbt_george`.`stg_customers`
    where customer_id is not null
    group by customer_id
    having count(*) > 1

) validation_errors



2021-05-12 16:00:20.147998 (Thread-1): finished collecting timing info
2021-05-12 16:00:20.148373 (Thread-1): 17:00:20 | 6 of 7 PASS unique_stg_customers_customer_id......................... [PASS in 1.27s]
2021-05-12 16:00:20.148500 (Thread-1): Finished running node test.jaffle_shop.unique_stg_customers_customer_id
2021-05-12 16:00:20.148620 (Thread-1): Began running node test.jaffle_shop.unique_stg_orders_order_id
2021-05-12 16:00:20.148797 (Thread-1): 17:00:20 | 7 of 7 START test unique_stg_orders_order_id......................... [RUN]
2021-05-12 16:00:20.149055 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_orders_order_id".
2021-05-12 16:00:20.149170 (Thread-1): Compiling test.jaffle_shop.unique_stg_orders_order_id
2021-05-12 16:00:20.149793 (Thread-1): unclosed <socket.socket fd=16, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:5134:cde0:9e85:d6f3', 54589, 0, 0), raddr=('2a00:1450:4009:823::200a', 443, 0, 0)>
2021-05-12 16:00:20.149929 (Thread-1): unclosed <socket.socket fd=17, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:5134:cde0:9e85:d6f3', 54590, 0, 0), raddr=('2a00:1450:4009:823::200a', 443, 0, 0)>
2021-05-12 16:00:20.152436 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id"
2021-05-12 16:00:20.158119 (Thread-1): finished collecting timing info
2021-05-12 16:00:20.158272 (Thread-1): Opening a new connection, currently in state closed
2021-05-12 16:00:20.163415 (Thread-1): On test.jaffle_shop.unique_stg_orders_order_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id"} */

    
    



select count(*) as validation_errors
from (

    select
        order_id

    from `acquired-rite-313314`.`dbt_george`.`stg_orders`
    where order_id is not null
    group by order_id
    having count(*) > 1

) validation_errors



2021-05-12 16:00:21.506493 (Thread-1): finished collecting timing info
2021-05-12 16:00:21.507018 (Thread-1): 17:00:21 | 7 of 7 PASS unique_stg_orders_order_id............................... [PASS in 1.36s]
2021-05-12 16:00:21.507211 (Thread-1): Finished running node test.jaffle_shop.unique_stg_orders_order_id
2021-05-12 16:00:21.509269 (MainThread): Acquiring new bigquery connection "master".
2021-05-12 16:00:21.509656 (MainThread): 17:00:21 | 
2021-05-12 16:00:21.509789 (MainThread): 17:00:21 | Finished running 7 tests in 10.63s.
2021-05-12 16:00:21.509910 (MainThread): Connection 'master' was properly closed.
2021-05-12 16:00:21.509992 (MainThread): Connection 'test.jaffle_shop.unique_stg_orders_order_id' was properly closed.
2021-05-12 16:00:21.517215 (MainThread): 
2021-05-12 16:00:21.517421 (MainThread): Completed with 1 error and 0 warnings:
2021-05-12 16:00:21.517542 (MainThread): 
2021-05-12 16:00:21.517652 (MainThread): Failure in test accepted_values_stg_orders_status__placed__shipped__completed__return_pending (models/schema.yml)
2021-05-12 16:00:21.517745 (MainThread):   Got 1 result, expected 0.
2021-05-12 16:00:21.517831 (MainThread): 
2021-05-12 16:00:21.517924 (MainThread):   compiled SQL at target/compiled/jaffle_shop/models/schema.yml/schema_test/accepted_values_stg_orders_d58c471b6d7acb11424d37994ba6068d.sql
2021-05-12 16:00:21.518034 (MainThread): 
Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
2021-05-12 16:00:21.518192 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb05b8b2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb0596a8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb05a45e80>]}
2021-05-12 16:00:21.518374 (MainThread): Flushing usage events
2021-05-13 12:21:02.547094 (MainThread): Running with dbt=0.19.1
2021-05-13 12:21:03.523939 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/georgefearnley/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-05-13 12:21:03.529227 (MainThread): Tracking: tracking
2021-05-13 12:21:03.551779 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa79daff040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa79da94580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa79da94520>]}
2021-05-13 12:21:03.571016 (MainThread): Partial parsing not enabled
2021-05-13 12:21:03.578137 (MainThread): Parsing macros/etc.sql
2021-05-13 12:21:03.590022 (MainThread): Parsing macros/catalog.sql
2021-05-13 12:21:03.600136 (MainThread): Parsing macros/adapters.sql
2021-05-13 12:21:03.623937 (MainThread): Parsing macros/materializations/seed.sql
2021-05-13 12:21:03.627866 (MainThread): Parsing macros/materializations/view.sql
2021-05-13 12:21:03.631872 (MainThread): Parsing macros/materializations/table.sql
2021-05-13 12:21:03.644261 (MainThread): Parsing macros/materializations/copy.sql
2021-05-13 12:21:03.661602 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-13 12:21:03.698340 (MainThread): Parsing macros/materializations/snapshot.sql
2021-05-13 12:21:03.709374 (MainThread): Parsing macros/core.sql
2021-05-13 12:21:03.716441 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-13 12:21:03.729873 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-13 12:21:03.734610 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-13 12:21:03.768988 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-13 12:21:03.814696 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-13 12:21:03.844591 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-13 12:21:03.849171 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-13 12:21:03.858980 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-13 12:21:03.878440 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-13 12:21:03.889094 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-13 12:21:03.899103 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-13 12:21:03.907277 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-13 12:21:03.910039 (MainThread): Parsing macros/etc/query.sql
2021-05-13 12:21:03.912830 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-13 12:21:03.917774 (MainThread): Parsing macros/etc/datetime.sql
2021-05-13 12:21:03.931049 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-13 12:21:03.935301 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-13 12:21:03.939742 (MainThread): Parsing macros/adapters/common.sql
2021-05-13 12:21:03.997132 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-13 12:21:04.001503 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-13 12:21:04.005074 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-13 12:21:04.008907 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-13 12:21:04.019223 (MainThread): Partial parsing not enabled
2021-05-13 12:21:04.053010 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-05-13 12:21:04.066601 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-05-13 12:21:04.077544 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-05-13 12:21:04.199400 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '10b09c0f-2144-4722-905c-01d4c3ecefed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa79de8d0a0>]}
2021-05-13 12:21:04.212783 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '10b09c0f-2144-4722-905c-01d4c3ecefed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa79db2c580>]}
2021-05-13 12:21:04.213122 (MainThread): Found 3 models, 7 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-13 12:21:04.214594 (MainThread): 
2021-05-13 12:21:04.215027 (MainThread): Acquiring new bigquery connection "master".
2021-05-13 12:21:04.216577 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_acquired-rite-313314_dbt_george".
2021-05-13 12:21:04.216842 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-13 12:21:04.225824 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-13 12:21:04.689002 (MainThread): 13:21:04 | Concurrency: 1 threads (target='dev')
2021-05-13 12:21:04.689248 (MainThread): 13:21:04 | 
2021-05-13 12:21:04.700822 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending
2021-05-13 12:21:04.701084 (Thread-1): 13:21:04 | 1 of 7 START test accepted_values_stg_orders_status__placed__shipped__completed__return_pending [RUN]
2021-05-13 12:21:04.701455 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending".
2021-05-13 12:21:04.701619 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending
2021-05-13 12:21:04.714280 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending"
2021-05-13 12:21:04.716791 (Thread-1): finished collecting timing info
2021-05-13 12:21:04.717024 (Thread-1): Opening a new connection, currently in state closed
2021-05-13 12:21:04.723531 (Thread-1): On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending"} */

    
    




with all_values as (

    select distinct
        status as value_field

    from `acquired-rite-313314`.`dbt_george`.`stg_orders`

),

validation_errors as (

    select
        value_field

    from all_values
    where value_field not in (
        'placed','shipped','completed','return_pending'
    )
)

select count(*) as validation_errors
from validation_errors



2021-05-13 12:21:06.168759 (Thread-1): finished collecting timing info
2021-05-13 12:21:06.169289 (Thread-1): 13:21:06 | 1 of 7 FAIL 1 accepted_values_stg_orders_status__placed__shipped__completed__return_pending [FAIL 1 in 1.47s]
2021-05-13 12:21:06.169474 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending
2021-05-13 12:21:06.169670 (Thread-1): Began running node test.jaffle_shop.not_null_customers_customer_id
2021-05-13 12:21:06.169941 (Thread-1): 13:21:06 | 2 of 7 START test not_null_customers_customer_id..................... [RUN]
2021-05-13 12:21:06.170258 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_customers_customer_id".
2021-05-13 12:21:06.170391 (Thread-1): Compiling test.jaffle_shop.not_null_customers_customer_id
2021-05-13 12:21:06.171110 (Thread-1): unclosed <socket.socket fd=16, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:60c4:b8b9:b85f:c9', 57063, 0, 0), raddr=('2a00:1450:4009:817::200a', 443, 0, 0)>
2021-05-13 12:21:06.171316 (Thread-1): unclosed <socket.socket fd=17, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:60c4:b8b9:b85f:c9', 57064, 0, 0), raddr=('2a00:1450:4009:80a::200a', 443, 0, 0)>
2021-05-13 12:21:06.178877 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id"
2021-05-13 12:21:06.181787 (Thread-1): finished collecting timing info
2021-05-13 12:21:06.182029 (Thread-1): Opening a new connection, currently in state closed
2021-05-13 12:21:06.188764 (Thread-1): On test.jaffle_shop.not_null_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_customers_customer_id"} */

    
    



select count(*) as validation_errors
from `acquired-rite-313314`.`dbt_george`.`customers`
where customer_id is null



2021-05-13 12:21:08.133529 (Thread-1): finished collecting timing info
2021-05-13 12:21:08.134015 (Thread-1): 13:21:08 | 2 of 7 PASS not_null_customers_customer_id........................... [PASS in 1.96s]
2021-05-13 12:21:08.134196 (Thread-1): Finished running node test.jaffle_shop.not_null_customers_customer_id
2021-05-13 12:21:08.134352 (Thread-1): Began running node test.jaffle_shop.not_null_stg_customers_customer_id
2021-05-13 12:21:08.134582 (Thread-1): 13:21:08 | 3 of 7 START test not_null_stg_customers_customer_id................. [RUN]
2021-05-13 12:21:08.134868 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id".
2021-05-13 12:21:08.135005 (Thread-1): Compiling test.jaffle_shop.not_null_stg_customers_customer_id
2021-05-13 12:21:08.138626 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id"
2021-05-13 12:21:08.144220 (Thread-1): finished collecting timing info
2021-05-13 12:21:08.144466 (Thread-1): Opening a new connection, currently in state closed
2021-05-13 12:21:08.151099 (Thread-1): On test.jaffle_shop.not_null_stg_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id"} */

    
    



select count(*) as validation_errors
from `acquired-rite-313314`.`dbt_george`.`stg_customers`
where customer_id is null



2021-05-13 12:21:09.369490 (Thread-1): finished collecting timing info
2021-05-13 12:21:09.370086 (Thread-1): 13:21:09 | 3 of 7 PASS not_null_stg_customers_customer_id....................... [PASS in 1.24s]
2021-05-13 12:21:09.370254 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id
2021-05-13 12:21:09.370416 (Thread-1): Began running node test.jaffle_shop.not_null_stg_orders_order_id
2021-05-13 12:21:09.370647 (Thread-1): 13:21:09 | 4 of 7 START test not_null_stg_orders_order_id....................... [RUN]
2021-05-13 12:21:09.370929 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_order_id".
2021-05-13 12:21:09.371053 (Thread-1): Compiling test.jaffle_shop.not_null_stg_orders_order_id
2021-05-13 12:21:09.375034 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id"
2021-05-13 12:21:09.398252 (Thread-1): finished collecting timing info
2021-05-13 12:21:09.398537 (Thread-1): Opening a new connection, currently in state closed
2021-05-13 12:21:09.405376 (Thread-1): On test.jaffle_shop.not_null_stg_orders_order_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id"} */

    
    



select count(*) as validation_errors
from `acquired-rite-313314`.`dbt_george`.`stg_orders`
where order_id is null



2021-05-13 12:21:10.787664 (Thread-1): finished collecting timing info
2021-05-13 12:21:10.788161 (Thread-1): 13:21:10 | 4 of 7 PASS not_null_stg_orders_order_id............................. [PASS in 1.42s]
2021-05-13 12:21:10.788342 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_orders_order_id
2021-05-13 12:21:10.788562 (Thread-1): Began running node test.jaffle_shop.unique_customers_customer_id
2021-05-13 12:21:10.788832 (Thread-1): 13:21:10 | 5 of 7 START test unique_customers_customer_id....................... [RUN]
2021-05-13 12:21:10.789154 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_customers_customer_id".
2021-05-13 12:21:10.789391 (Thread-1): Compiling test.jaffle_shop.unique_customers_customer_id
2021-05-13 12:21:10.790255 (Thread-1): unclosed <socket.socket fd=20, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:60c4:b8b9:b85f:c9', 57075, 0, 0), raddr=('2a00:1450:4009:817::200a', 443, 0, 0)>
2021-05-13 12:21:10.790440 (Thread-1): unclosed <socket.socket fd=21, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:60c4:b8b9:b85f:c9', 57076, 0, 0), raddr=('2a00:1450:4009:80a::200a', 443, 0, 0)>
2021-05-13 12:21:10.797078 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id"
2021-05-13 12:21:10.819326 (Thread-1): finished collecting timing info
2021-05-13 12:21:10.819636 (Thread-1): Opening a new connection, currently in state closed
2021-05-13 12:21:10.827040 (Thread-1): On test.jaffle_shop.unique_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_customers_customer_id"} */

    
    



select count(*) as validation_errors
from (

    select
        customer_id

    from `acquired-rite-313314`.`dbt_george`.`customers`
    where customer_id is not null
    group by customer_id
    having count(*) > 1

) validation_errors



2021-05-13 12:21:10.876291 (Thread-1): unclosed <socket.socket fd=10, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:60c4:b8b9:b85f:c9', 57061, 0, 0), raddr=('2a00:1450:4009:817::200a', 443, 0, 0)>
2021-05-13 12:21:10.876541 (Thread-1): unclosed <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:60c4:b8b9:b85f:c9', 57062, 0, 0), raddr=('2a00:1450:4009:80a::200a', 443, 0, 0)>
2021-05-13 12:21:10.880839 (Thread-1): unclosed <socket.socket fd=16, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:60c4:b8b9:b85f:c9', 57067, 0, 0), raddr=('2a00:1450:4009:817::200a', 443, 0, 0)>
2021-05-13 12:21:10.881139 (Thread-1): unclosed <socket.socket fd=17, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:60c4:b8b9:b85f:c9', 57068, 0, 0), raddr=('2a00:1450:4009:80a::200a', 443, 0, 0)>
2021-05-13 12:21:10.881549 (Thread-1): unclosed <socket.socket fd=19, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:60c4:b8b9:b85f:c9', 57074, 0, 0), raddr=('2a00:1450:4009:80a::200a', 443, 0, 0)>
2021-05-13 12:21:10.881728 (Thread-1): unclosed <socket.socket fd=18, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:60c4:b8b9:b85f:c9', 57073, 0, 0), raddr=('2a00:1450:4009:817::200a', 443, 0, 0)>
2021-05-13 12:21:12.090316 (Thread-1): finished collecting timing info
2021-05-13 12:21:12.090801 (Thread-1): 13:21:12 | 5 of 7 PASS unique_customers_customer_id............................. [PASS in 1.30s]
2021-05-13 12:21:12.090973 (Thread-1): Finished running node test.jaffle_shop.unique_customers_customer_id
2021-05-13 12:21:12.091132 (Thread-1): Began running node test.jaffle_shop.unique_stg_customers_customer_id
2021-05-13 12:21:12.091364 (Thread-1): 13:21:12 | 6 of 7 START test unique_stg_customers_customer_id................... [RUN]
2021-05-13 12:21:12.091640 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id".
2021-05-13 12:21:12.091769 (Thread-1): Compiling test.jaffle_shop.unique_stg_customers_customer_id
2021-05-13 12:21:12.095608 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id"
2021-05-13 12:21:12.098170 (Thread-1): finished collecting timing info
2021-05-13 12:21:12.098411 (Thread-1): Opening a new connection, currently in state closed
2021-05-13 12:21:12.105456 (Thread-1): On test.jaffle_shop.unique_stg_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id"} */

    
    



select count(*) as validation_errors
from (

    select
        customer_id

    from `acquired-rite-313314`.`dbt_george`.`stg_customers`
    where customer_id is not null
    group by customer_id
    having count(*) > 1

) validation_errors



2021-05-13 12:21:13.351246 (Thread-1): finished collecting timing info
2021-05-13 12:21:13.351605 (Thread-1): 13:21:13 | 6 of 7 PASS unique_stg_customers_customer_id......................... [PASS in 1.26s]
2021-05-13 12:21:13.351781 (Thread-1): Finished running node test.jaffle_shop.unique_stg_customers_customer_id
2021-05-13 12:21:13.351889 (Thread-1): Began running node test.jaffle_shop.unique_stg_orders_order_id
2021-05-13 12:21:13.351988 (Thread-1): 13:21:13 | 7 of 7 START test unique_stg_orders_order_id......................... [RUN]
2021-05-13 12:21:13.352244 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_orders_order_id".
2021-05-13 12:21:13.352445 (Thread-1): Compiling test.jaffle_shop.unique_stg_orders_order_id
2021-05-13 12:21:13.352969 (Thread-1): unclosed <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:60c4:b8b9:b85f:c9', 57080, 0, 0), raddr=('2a00:1450:4009:817::200a', 443, 0, 0)>
2021-05-13 12:21:13.353239 (Thread-1): unclosed <socket.socket fd=16, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:60c4:b8b9:b85f:c9', 57081, 0, 0), raddr=('2a00:1450:4009:80a::200a', 443, 0, 0)>
2021-05-13 12:21:13.355564 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id"
2021-05-13 12:21:13.358431 (Thread-1): finished collecting timing info
2021-05-13 12:21:13.358657 (Thread-1): Opening a new connection, currently in state closed
2021-05-13 12:21:13.363506 (Thread-1): On test.jaffle_shop.unique_stg_orders_order_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id"} */

    
    



select count(*) as validation_errors
from (

    select
        order_id

    from `acquired-rite-313314`.`dbt_george`.`stg_orders`
    where order_id is not null
    group by order_id
    having count(*) > 1

) validation_errors



2021-05-13 12:21:14.828187 (Thread-1): finished collecting timing info
2021-05-13 12:21:14.828774 (Thread-1): 13:21:14 | 7 of 7 PASS unique_stg_orders_order_id............................... [PASS in 1.48s]
2021-05-13 12:21:14.828939 (Thread-1): Finished running node test.jaffle_shop.unique_stg_orders_order_id
2021-05-13 12:21:14.830427 (MainThread): Acquiring new bigquery connection "master".
2021-05-13 12:21:14.830771 (MainThread): 13:21:14 | 
2021-05-13 12:21:14.830920 (MainThread): 13:21:14 | Finished running 7 tests in 10.62s.
2021-05-13 12:21:14.831038 (MainThread): Connection 'master' was properly closed.
2021-05-13 12:21:14.831124 (MainThread): Connection 'test.jaffle_shop.unique_stg_orders_order_id' was properly closed.
2021-05-13 12:21:14.858754 (MainThread): 
2021-05-13 12:21:14.858959 (MainThread): Completed with 1 error and 0 warnings:
2021-05-13 12:21:14.859090 (MainThread): 
2021-05-13 12:21:14.859224 (MainThread): Failure in test accepted_values_stg_orders_status__placed__shipped__completed__return_pending (models/schema.yml)
2021-05-13 12:21:14.859346 (MainThread):   Got 1 result, expected 0.
2021-05-13 12:21:14.859457 (MainThread): 
2021-05-13 12:21:14.859573 (MainThread):   compiled SQL at target/compiled/jaffle_shop/models/schema.yml/schema_test/accepted_values_stg_orders_d58c471b6d7acb11424d37994ba6068d.sql
2021-05-13 12:21:14.859713 (MainThread): 
Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
2021-05-13 12:21:14.859910 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa79dd63430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa79de8da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa79de8d910>]}
2021-05-13 12:21:14.860143 (MainThread): Flushing usage events
2021-05-13 12:28:00.712234 (MainThread): Running with dbt=0.19.1
2021-05-13 12:28:01.158226 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['stg_orders'], partial_parse=None, profile=None, profiles_dir='/Users/georgefearnley/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-05-13 12:28:01.160235 (MainThread): Tracking: tracking
2021-05-13 12:28:01.173754 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadaaf765b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadaaf0f580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadaaf0f520>]}
2021-05-13 12:28:01.189985 (MainThread): Partial parsing not enabled
2021-05-13 12:28:01.191836 (MainThread): Parsing macros/etc.sql
2021-05-13 12:28:01.196034 (MainThread): Parsing macros/catalog.sql
2021-05-13 12:28:01.203161 (MainThread): Parsing macros/adapters.sql
2021-05-13 12:28:01.223704 (MainThread): Parsing macros/materializations/seed.sql
2021-05-13 12:28:01.227102 (MainThread): Parsing macros/materializations/view.sql
2021-05-13 12:28:01.230526 (MainThread): Parsing macros/materializations/table.sql
2021-05-13 12:28:01.241628 (MainThread): Parsing macros/materializations/copy.sql
2021-05-13 12:28:01.246807 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-13 12:28:01.260778 (MainThread): Parsing macros/materializations/snapshot.sql
2021-05-13 12:28:01.266320 (MainThread): Parsing macros/core.sql
2021-05-13 12:28:01.271180 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-13 12:28:01.281129 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-13 12:28:01.283567 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-13 12:28:01.303464 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-13 12:28:01.339105 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-13 12:28:01.361256 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-13 12:28:01.363613 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-13 12:28:01.370694 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-13 12:28:01.386324 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-13 12:28:01.394255 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-13 12:28:01.401524 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-13 12:28:01.407346 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-13 12:28:01.408860 (MainThread): Parsing macros/etc/query.sql
2021-05-13 12:28:01.410458 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-13 12:28:01.412510 (MainThread): Parsing macros/etc/datetime.sql
2021-05-13 12:28:01.422085 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-13 12:28:01.424678 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-13 12:28:01.427121 (MainThread): Parsing macros/adapters/common.sql
2021-05-13 12:28:01.477340 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-13 12:28:01.479912 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-13 12:28:01.482094 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-13 12:28:01.484387 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-13 12:28:01.493000 (MainThread): Partial parsing not enabled
2021-05-13 12:28:01.517795 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-05-13 12:28:01.527887 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-05-13 12:28:01.532649 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-05-13 12:28:01.615453 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21985bb4-ace1-4646-8f58-447755736510', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadabe8d0a0>]}
2021-05-13 12:28:01.620805 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21985bb4-ace1-4646-8f58-447755736510', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadaaf96be0>]}
2021-05-13 12:28:01.621052 (MainThread): Found 3 models, 7 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-13 12:28:01.621899 (MainThread): 
2021-05-13 12:28:01.622254 (MainThread): Acquiring new bigquery connection "master".
2021-05-13 12:28:01.623527 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_acquired-rite-313314_dbt_george".
2021-05-13 12:28:01.623703 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-13 12:28:01.631445 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-13 12:28:02.032500 (MainThread): 13:28:02 | Concurrency: 1 threads (target='dev')
2021-05-13 12:28:02.032707 (MainThread): 13:28:02 | 
2021-05-13 12:28:02.035758 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2021-05-13 12:28:02.035947 (Thread-1): 13:28:02 | 1 of 3 START test accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned [RUN]
2021-05-13 12:28:02.036255 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned".
2021-05-13 12:28:02.036395 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2021-05-13 12:28:02.047847 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned"
2021-05-13 12:28:02.050431 (Thread-1): finished collecting timing info
2021-05-13 12:28:02.050638 (Thread-1): Opening a new connection, currently in state closed
2021-05-13 12:28:02.057145 (Thread-1): On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned"} */

    
    




with all_values as (

    select distinct
        status as value_field

    from `acquired-rite-313314`.`dbt_george`.`stg_orders`

),

validation_errors as (

    select
        value_field

    from all_values
    where value_field not in (
        'placed','shipped','completed','return_pending','returned'
    )
)

select count(*) as validation_errors
from validation_errors



2021-05-13 12:28:03.406770 (Thread-1): finished collecting timing info
2021-05-13 12:28:03.407175 (Thread-1): 13:28:03 | 1 of 3 PASS accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned [PASS in 1.37s]
2021-05-13 12:28:03.407311 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2021-05-13 12:28:03.407438 (Thread-1): Began running node test.jaffle_shop.not_null_stg_orders_order_id
2021-05-13 12:28:03.407649 (Thread-1): 13:28:03 | 2 of 3 START test not_null_stg_orders_order_id....................... [RUN]
2021-05-13 12:28:03.407910 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_order_id".
2021-05-13 12:28:03.408017 (Thread-1): Compiling test.jaffle_shop.not_null_stg_orders_order_id
2021-05-13 12:28:03.408604 (Thread-1): unclosed <socket.socket fd=16, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:60c4:b8b9:b85f:c9', 57328, 0, 0), raddr=('2a00:1450:4009:821::200a', 443, 0, 0)>
2021-05-13 12:28:03.408755 (Thread-1): unclosed <socket.socket fd=17, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:60c4:b8b9:b85f:c9', 57329, 0, 0), raddr=('2a00:1450:4009:80a::200a', 443, 0, 0)>
2021-05-13 12:28:03.414340 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id"
2021-05-13 12:28:03.415856 (Thread-1): finished collecting timing info
2021-05-13 12:28:03.416018 (Thread-1): Opening a new connection, currently in state closed
2021-05-13 12:28:03.421248 (Thread-1): On test.jaffle_shop.not_null_stg_orders_order_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id"} */

    
    



select count(*) as validation_errors
from `acquired-rite-313314`.`dbt_george`.`stg_orders`
where order_id is null



2021-05-13 12:28:04.699640 (Thread-1): finished collecting timing info
2021-05-13 12:28:04.700135 (Thread-1): 13:28:04 | 2 of 3 PASS not_null_stg_orders_order_id............................. [PASS in 1.29s]
2021-05-13 12:28:04.700309 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_orders_order_id
2021-05-13 12:28:04.700469 (Thread-1): Began running node test.jaffle_shop.unique_stg_orders_order_id
2021-05-13 12:28:04.700691 (Thread-1): 13:28:04 | 3 of 3 START test unique_stg_orders_order_id......................... [RUN]
2021-05-13 12:28:04.701026 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_orders_order_id".
2021-05-13 12:28:04.701165 (Thread-1): Compiling test.jaffle_shop.unique_stg_orders_order_id
2021-05-13 12:28:04.708515 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id"
2021-05-13 12:28:04.710633 (Thread-1): finished collecting timing info
2021-05-13 12:28:04.710834 (Thread-1): Opening a new connection, currently in state closed
2021-05-13 12:28:04.717078 (Thread-1): On test.jaffle_shop.unique_stg_orders_order_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id"} */

    
    



select count(*) as validation_errors
from (

    select
        order_id

    from `acquired-rite-313314`.`dbt_george`.`stg_orders`
    where order_id is not null
    group by order_id
    having count(*) > 1

) validation_errors



2021-05-13 12:28:05.949473 (Thread-1): finished collecting timing info
2021-05-13 12:28:05.949854 (Thread-1): 13:28:05 | 3 of 3 PASS unique_stg_orders_order_id............................... [PASS in 1.25s]
2021-05-13 12:28:05.949985 (Thread-1): Finished running node test.jaffle_shop.unique_stg_orders_order_id
2021-05-13 12:28:05.950908 (MainThread): Acquiring new bigquery connection "master".
2021-05-13 12:28:05.951172 (MainThread): 13:28:05 | 
2021-05-13 12:28:05.951299 (MainThread): 13:28:05 | Finished running 3 tests in 4.33s.
2021-05-13 12:28:05.951402 (MainThread): Connection 'master' was properly closed.
2021-05-13 12:28:05.951482 (MainThread): Connection 'test.jaffle_shop.unique_stg_orders_order_id' was properly closed.
2021-05-13 12:28:05.952369 (MainThread): unclosed <socket.socket fd=18, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:60c4:b8b9:b85f:c9', 57334, 0, 0), raddr=('2a00:1450:4009:821::200a', 443, 0, 0)>
2021-05-13 12:28:05.952505 (MainThread): unclosed <socket.socket fd=19, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:60c4:b8b9:b85f:c9', 57335, 0, 0), raddr=('2a00:1450:4009:80a::200a', 443, 0, 0)>
2021-05-13 12:28:05.956863 (MainThread): 
2021-05-13 12:28:05.957036 (MainThread): Completed successfully
2021-05-13 12:28:05.957194 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-05-13 12:28:05.957361 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadabe8df70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadabd89d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadabd89a30>]}
2021-05-13 12:28:05.957567 (MainThread): Flushing usage events
2021-05-13 12:55:40.080379 (MainThread): Running with dbt=0.19.1
2021-05-13 12:55:40.657756 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/georgefearnley/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2021-05-13 12:55:40.659536 (MainThread): Tracking: tracking
2021-05-13 12:55:40.671520 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb76fe580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb768e550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb768e4f0>]}
2021-05-13 12:55:40.701950 (MainThread): Partial parsing not enabled
2021-05-13 12:55:40.703994 (MainThread): Parsing macros/etc.sql
2021-05-13 12:55:40.708425 (MainThread): Parsing macros/catalog.sql
2021-05-13 12:55:40.715663 (MainThread): Parsing macros/adapters.sql
2021-05-13 12:55:40.751078 (MainThread): Parsing macros/materializations/seed.sql
2021-05-13 12:55:40.754609 (MainThread): Parsing macros/materializations/view.sql
2021-05-13 12:55:40.758048 (MainThread): Parsing macros/materializations/table.sql
2021-05-13 12:55:40.768915 (MainThread): Parsing macros/materializations/copy.sql
2021-05-13 12:55:40.774269 (MainThread): Parsing macros/materializations/incremental.sql
2021-05-13 12:55:40.802036 (MainThread): Parsing macros/materializations/snapshot.sql
2021-05-13 12:55:40.809850 (MainThread): Parsing macros/core.sql
2021-05-13 12:55:40.815711 (MainThread): Parsing macros/materializations/helpers.sql
2021-05-13 12:55:40.825701 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-05-13 12:55:40.828052 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-05-13 12:55:40.851224 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-05-13 12:55:40.901105 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-05-13 12:55:40.923963 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-05-13 12:55:40.927014 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-05-13 12:55:40.933633 (MainThread): Parsing macros/materializations/common/merge.sql
2021-05-13 12:55:40.951296 (MainThread): Parsing macros/materializations/table/table.sql
2021-05-13 12:55:40.958626 (MainThread): Parsing macros/materializations/view/view.sql
2021-05-13 12:55:40.965643 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-05-13 12:55:40.971399 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-05-13 12:55:40.973071 (MainThread): Parsing macros/etc/query.sql
2021-05-13 12:55:40.974899 (MainThread): Parsing macros/etc/is_incremental.sql
2021-05-13 12:55:40.976935 (MainThread): Parsing macros/etc/datetime.sql
2021-05-13 12:55:41.001383 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-05-13 12:55:41.004488 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-05-13 12:55:41.007260 (MainThread): Parsing macros/adapters/common.sql
2021-05-13 12:55:41.053040 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-05-13 12:55:41.055773 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-05-13 12:55:41.057898 (MainThread): Parsing macros/schema_tests/unique.sql
2021-05-13 12:55:41.060250 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-05-13 12:55:41.068492 (MainThread): Partial parsing not enabled
2021-05-13 12:55:41.110675 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-05-13 12:55:41.121648 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-05-13 12:55:41.126273 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-05-13 12:55:41.214828 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d0e882f-b1c7-45af-800a-c36a5571930e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb8181ac0>]}
2021-05-13 12:55:41.220213 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d0e882f-b1c7-45af-800a-c36a5571930e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb7716610>]}
2021-05-13 12:55:41.220467 (MainThread): Found 3 models, 7 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-05-13 12:55:41.221430 (MainThread): 
2021-05-13 12:55:41.221711 (MainThread): Acquiring new bigquery connection "master".
2021-05-13 12:55:41.222813 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_acquired-rite-313314_dbt_george".
2021-05-13 12:55:41.223002 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-13 12:55:41.231974 (ThreadPoolExecutor-0_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-13 12:55:41.679113 (MainThread): 13:55:41 | Concurrency: 1 threads (target='dev')
2021-05-13 12:55:41.679367 (MainThread): 13:55:41 | 
2021-05-13 12:55:41.682886 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-05-13 12:55:41.683244 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-05-13 12:55:41.683392 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-05-13 12:55:41.684838 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-05-13 12:55:41.701784 (Thread-1): finished collecting timing info
2021-05-13 12:55:41.702002 (Thread-1): finished collecting timing info
2021-05-13 12:55:41.702313 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-05-13 12:55:41.702444 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-05-13 12:55:41.702812 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-05-13 12:55:41.703009 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-05-13 12:55:41.704150 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-05-13 12:55:41.707463 (Thread-1): finished collecting timing info
2021-05-13 12:55:41.707607 (Thread-1): finished collecting timing info
2021-05-13 12:55:41.707908 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-05-13 12:55:41.708039 (Thread-1): Began running node test.jaffle_shop.not_null_stg_customers_customer_id
2021-05-13 12:55:41.708343 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id".
2021-05-13 12:55:41.708559 (Thread-1): Compiling test.jaffle_shop.not_null_stg_customers_customer_id
2021-05-13 12:55:41.714409 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id"
2021-05-13 12:55:41.716086 (Thread-1): finished collecting timing info
2021-05-13 12:55:41.716372 (Thread-1): finished collecting timing info
2021-05-13 12:55:41.716738 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id
2021-05-13 12:55:41.716869 (Thread-1): Began running node test.jaffle_shop.unique_stg_customers_customer_id
2021-05-13 12:55:41.717179 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id".
2021-05-13 12:55:41.717282 (Thread-1): Compiling test.jaffle_shop.unique_stg_customers_customer_id
2021-05-13 12:55:41.723321 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id"
2021-05-13 12:55:41.724708 (Thread-1): finished collecting timing info
2021-05-13 12:55:41.724862 (Thread-1): finished collecting timing info
2021-05-13 12:55:41.725136 (Thread-1): Finished running node test.jaffle_shop.unique_stg_customers_customer_id
2021-05-13 12:55:41.725262 (Thread-1): Began running node model.jaffle_shop.customers
2021-05-13 12:55:41.725548 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-05-13 12:55:41.725650 (Thread-1): Compiling model.jaffle_shop.customers
2021-05-13 12:55:41.728043 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2021-05-13 12:55:41.730235 (Thread-1): finished collecting timing info
2021-05-13 12:55:41.730433 (Thread-1): finished collecting timing info
2021-05-13 12:55:41.730740 (Thread-1): Finished running node model.jaffle_shop.customers
2021-05-13 12:55:41.730882 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2021-05-13 12:55:41.731218 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned".
2021-05-13 12:55:41.731410 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2021-05-13 12:55:41.740705 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned"
2021-05-13 12:55:41.751498 (Thread-1): finished collecting timing info
2021-05-13 12:55:41.751732 (Thread-1): finished collecting timing info
2021-05-13 12:55:41.752130 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2021-05-13 12:55:41.752305 (Thread-1): Began running node test.jaffle_shop.not_null_stg_orders_order_id
2021-05-13 12:55:41.752642 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_order_id".
2021-05-13 12:55:41.752836 (Thread-1): Compiling test.jaffle_shop.not_null_stg_orders_order_id
2021-05-13 12:55:41.755926 (Thread-1): unclosed <socket.socket fd=10, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:60c4:b8b9:b85f:c9', 57644, 0, 0), raddr=('2a00:1450:4009:816::200a', 443, 0, 0)>
2021-05-13 12:55:41.756115 (Thread-1): unclosed <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('2a02:c7f:dcd5:2700:60c4:b8b9:b85f:c9', 57645, 0, 0), raddr=('2a00:1450:4009:80a::200a', 443, 0, 0)>
2021-05-13 12:55:41.757221 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id"
2021-05-13 12:55:41.758281 (Thread-1): finished collecting timing info
2021-05-13 12:55:41.758425 (Thread-1): finished collecting timing info
2021-05-13 12:55:41.758698 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_orders_order_id
2021-05-13 12:55:41.758834 (Thread-1): Began running node test.jaffle_shop.unique_stg_orders_order_id
2021-05-13 12:55:41.759140 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_orders_order_id".
2021-05-13 12:55:41.759265 (Thread-1): Compiling test.jaffle_shop.unique_stg_orders_order_id
2021-05-13 12:55:41.762101 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id"
2021-05-13 12:55:41.763377 (Thread-1): finished collecting timing info
2021-05-13 12:55:41.763505 (Thread-1): finished collecting timing info
2021-05-13 12:55:41.763742 (Thread-1): Finished running node test.jaffle_shop.unique_stg_orders_order_id
2021-05-13 12:55:41.763861 (Thread-1): Began running node test.jaffle_shop.not_null_customers_customer_id
2021-05-13 12:55:41.764072 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_customers_customer_id".
2021-05-13 12:55:41.764174 (Thread-1): Compiling test.jaffle_shop.not_null_customers_customer_id
2021-05-13 12:55:41.766816 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id"
2021-05-13 12:55:41.768204 (Thread-1): finished collecting timing info
2021-05-13 12:55:41.768338 (Thread-1): finished collecting timing info
2021-05-13 12:55:41.768582 (Thread-1): Finished running node test.jaffle_shop.not_null_customers_customer_id
2021-05-13 12:55:41.768700 (Thread-1): Began running node test.jaffle_shop.unique_customers_customer_id
2021-05-13 12:55:41.768914 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_customers_customer_id".
2021-05-13 12:55:41.769072 (Thread-1): Compiling test.jaffle_shop.unique_customers_customer_id
2021-05-13 12:55:41.771866 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id"
2021-05-13 12:55:41.773366 (Thread-1): finished collecting timing info
2021-05-13 12:55:41.773569 (Thread-1): finished collecting timing info
2021-05-13 12:55:41.773873 (Thread-1): Finished running node test.jaffle_shop.unique_customers_customer_id
2021-05-13 12:55:41.774630 (MainThread): Connection 'master' was properly closed.
2021-05-13 12:55:41.774724 (MainThread): Connection 'test.jaffle_shop.unique_customers_customer_id' was properly closed.
2021-05-13 12:55:41.779983 (MainThread): 13:55:41 | Done.
2021-05-13 12:55:41.930308 (MainThread): Acquiring new bigquery connection "generate_catalog".
2021-05-13 12:55:41.930492 (MainThread): 13:55:41 | Building catalog
2021-05-13 12:55:41.931623 (MainThread): Opening a new connection, currently in state init
2021-05-13 12:55:42.303426 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "acquired-rite-313314.information_schema".
2021-05-13 12:55:42.319797 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-13 12:55:42.325222 (ThreadPoolExecutor-1_0): On acquired-rite-313314.information_schema: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "acquired-rite-313314.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `acquired-rite-313314`.`dbt_george`.__TABLES__
        where (upper(dataset_id) = upper('dbt_george'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `acquired-rite-313314`.`dbt_george`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `acquired-rite-313314`.`dbt_george`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
2021-05-13 12:55:45.005936 (MainThread): 13:55:45 | Catalog written to /Users/georgefearnley/Documents/dev/project_Snowball/dbt-tutorial/jaffle_shop/target/catalog.json
2021-05-13 12:55:45.006154 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb76fe580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb850bc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb85241f0>]}
2021-05-13 12:55:45.006333 (MainThread): Flushing usage events
2021-05-13 12:55:45.430937 (MainThread): Connection 'generate_catalog' was properly closed.
2021-05-13 12:55:45.431128 (MainThread): Connection 'acquired-rite-313314.information_schema' was properly closed.
2021-05-13 12:55:59.326639 (MainThread): Running with dbt=0.19.1
2021-05-13 12:55:59.804960 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', open_browser=True, partial_parse=None, port=8080, profile=None, profiles_dir='/Users/georgefearnley/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='serve', write_json=True)
2021-05-13 12:55:59.806734 (MainThread): Tracking: tracking
2021-05-13 12:55:59.816725 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0a53fe5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0a538d5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0a538d550>]}
2021-05-13 12:55:59.820123 (MainThread): Serving docs at 0.0.0.0:8080
2021-05-13 12:55:59.820341 (MainThread): To access from your browser, navigate to:  http://localhost:8080
2021-05-13 12:55:59.820471 (MainThread): Press Ctrl+C to exit.


2021-05-13 13:01:20.081882 (MainThread): Flushing usage events
2021-05-13 13:01:20.541993 (MainThread): ctrl-c
